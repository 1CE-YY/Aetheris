2026-01-09 15:23:46.328 [tomcat-handler-16] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 15:23:46.330 [tomcat-handler-16] INFO  c.a.rag.controller.AuthController - GET /api/auth/me - userId: 7
2026-01-09 15:23:46.336 [tomcat-handler-16] DEBUG c.a.rag.service.impl.AuthServiceImpl - 获取当前用户信息: userId=7
2026-01-09 15:23:46.336 [tomcat-handler-16] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:23:46.336 [tomcat-handler-16] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a60213f]
2026-01-09 15:23:46.336 [tomcat-handler-16] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@9980495 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will be managed by Spring
2026-01-09 15:23:46.336 [tomcat-handler-16] DEBUG c.a.rag.mapper.UserMapper.findById - ==>  Preparing: SELECT id, username, email, password_hash, created_at, updated_at, last_active_at FROM users WHERE id = ?
2026-01-09 15:23:46.336 [tomcat-handler-16] DEBUG c.a.rag.mapper.UserMapper.findById - ==> Parameters: 7(Long)
2026-01-09 15:23:46.338 [tomcat-handler-16] DEBUG c.a.rag.mapper.UserMapper.findById - <==      Total: 1
2026-01-09 15:23:46.338 [tomcat-handler-16] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a60213f]
2026-01-09 15:23:46.338 [tomcat-handler-16] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a60213f]
2026-01-09 15:23:46.339 [tomcat-handler-16] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a60213f]
2026-01-09 15:23:46.339 [tomcat-handler-16] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a60213f]
2026-01-09 15:23:48.923 [tomcat-handler-17] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 15:23:48.924 [tomcat-handler-17] INFO  c.a.rag.controller.ChatController - POST /api/chat/ask - userId=7, question='什么是Javascript', topK=5
2026-01-09 15:23:48.924 [tomcat-handler-17] INFO  c.a.rag.service.impl.RagServiceImpl - 执行问答：userId=7, question='什么是Javascript', useRag=true, topK=5
2026-01-09 15:23:48.924 [tomcat-handler-17] INFO  c.a.r.service.impl.SearchServiceImpl - 执行聚合语义检索：query='什么是Javascript', topK=5
2026-01-09 15:23:48.924 [tomcat-handler-17] INFO  c.a.r.service.impl.SearchServiceImpl - 执行语义检索：query='什么是Javascript', topK=10
2026-01-09 15:23:48.927 [tomcat-handler-17] DEBUG c.a.rag.gateway.cache.EmbeddingCache - Embedding cache hit for textHash: 1022509c75a70b2209358236a83f3b622c5985f65f78d38c1ec287899e07f75d
2026-01-09 15:23:48.927 [tomcat-handler-17] DEBUG c.a.rag.gateway.EmbeddingGateway - Embedding 缓存命中：textHash=1022509c
2026-01-09 15:23:48.927 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 查询向量化完成，维度：2048
2026-01-09 15:23:48.927 [tomcat-handler-17] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'embedding' completed in 2 ms
2026-01-09 15:23:48.927 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 查询向量已转换为二进制格式，大小：8192 字节
2026-01-09 15:23:48.927 [tomcat-handler-17] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'vector_conversion' completed in 0 ms
2026-01-09 15:23:48.929 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - FT.SEARCH 原始结果: [[B@4ef87c6d, [], [B@7415f477, [B@369d0288, [B@25b52b77, [[[B@28a320b8, [B@73cedf97, [B@2d990a24, [[B@21fb7273, [B@106c2014, [B@15db67e9, [B@70f6875c, [B@ae41bdb, [B@7b79e613, [B@355322ba, [B@71db9f2b, [B@5b4b7808, [B@6fb6440c], [B@43dcedb2, []], [[B@6ed31025, [B@6e58becf, [B@3393112c, [[B@1706cb91, [B@6122b36c, [B@4aa7c741, [B@6196b548, [B@406db0a8, [B@3420d21a, [B@40499610, [B@142157a4, [B@39e44d78, [B@be6f85c], [B@7130626, []], [[B@1991fd17, [B@205ecd0, [B@3e9dc0d4, [[B@21a0d317, [B@37cfeb71, [B@1a01e234, [B@4a4a0ac0, [B@6d5550f5, [B@2589aa4d, [B@300cfc8a, [B@2a0afc41, [B@6d1fc30d, [B@5acd721], [B@529393b2, []], [[B@2f869555, [B@3c123c03, [B@5f64e17f, [[B@1124f722, [B@a13f46e, [B@27cc330b, [B@5f5b5194, [B@697020ba, [B@7cd5097e, [B@3a472984, [B@3f1508a9, [B@57089a01, [B@3c2e767], [B@caf592, []], [[B@178df562, [B@4c6ad00, [B@10ab8b20, [[B@471a9ac2, [B@3fc451a6, [B@e5b45f3, [B@42652d93, [B@513a6397, [B@4cee5177, [B@18cef1c4, [B@73ac4efb, [B@7188bdc2, [B@4fd33f6d], [B@20fca782, []], [[B@3136eef0, [B@56423b9, [B@539a5c2f, [[B@169f3169, [B@10581c24, [B@34059c7d, [B@357fd5f6, [B@5a84ae49, [B@a6d2001, [B@1213b345, [B@59881494, [B@26011f0a, [B@450f4ee3], [B@4a89449c, []], [[B@533cc5ed, [B@7d6b79cf, [B@42ac48d7, [[B@428149ba, [B@7727efaa, [B@51244580, [B@71ee4583, [B@39ea0e9d, [B@71f8ecb5, [B@203af4f, [B@14220d1, [B@68b55882, [B@5e9e8c65], [B@4178392e, []], [[B@512cdd78, [B@139fee97, [B@3948a525, [[B@39794a6b, [B@e899721, [B@620e2b31, [B@1e93cbd8, [B@6d4ae073, [B@2f384264, [B@3c7cb311, [B@3cb1724d, [B@6c244d0, [B@6b040d0e], [B@3239cf44, []], [[B@5adf054, [B@115dc0f5, [B@5afac3ad, [[B@26456459, [B@4c800f95, [B@33a53498, [B@3fce7eea, [B@3224a2e6, [B@7e94ff90, [B@648f052e, [B@287a1e7b, [B@3f5eaa00, [B@66efaa04], [B@7a557582, []], [[B@2a43575, [B@48e0918b, [B@5344ad19, [[B@26c3b96, [B@2140b933, [B@6d600859, [B@1b3a5c89, [B@786974f3, [B@5c44d3ec, [B@318b2afd, [B@781ce651, [B@4be1cb4d, [B@31c0aa6e], [B@5974a269, []]], [B@46c5f978, 10, [B@33be94e, []]
2026-01-09 15:23:48.929 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 结果类型: java.util.ArrayList, 大小: 10
2026-01-09 15:23:48.929 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 开始解析搜索结果，result 类型: java.util.ArrayList
2026-01-09 15:23:48.929 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 结果列表大小: 10
2026-01-09 15:23:48.929 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 检测到 NestedMultiOutput 格式
2026-01-09 15:23:48.929 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 找到 results 键，值类型: java.util.ArrayList, 大小: 10
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[0]: List, 大小=6
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[1]: List, 大小=6
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[2]: List, 大小=6
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[3]: List, 大小=6
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[4]: List, 大小=6
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[5]: List, 大小=6
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[6]: List, 大小=6
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[7]: List, 大小=6
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[8]: List, 大小=6
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[9]: List, 大小=6
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 文档列表大小: 6
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[0]: byte[] = "id"
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[1]: byte[] = "chunk:548"
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[2]: byte[] = "extra_attributes"
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[3]: List, 大小=10
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[4]: byte[] = "values"
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[5]: List, 大小=0
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 处理文档 ID: chunk:548
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 字段列表大小: 10
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: __score -> 0.386950433254
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkId -> 548
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: resourceId -> 5
2026-01-09 15:23:48.930 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkIndex -> 0
2026-01-09 15:23:48.931 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkText -> 第二章. Javascript它是一种脚本语言，可以用来更改页面内容，控制多媒体，制作图像、动画等等例子修改页面内容修改页面内容js 代码位置<script>
	// js 代码
</script>
... (长度: 800)
2026-01-09 15:23:48.931 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 文档 chunk:548 解析到 5 个字段: [chunkText, resourceId, chunkIndex, __score, chunkId]
2026-01-09 15:23:48.931 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:23:48.931 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@371ca09d] was not registered for synchronization because synchronization is not active
2026-01-09 15:23:48.932 [tomcat-handler-17] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@1258765309 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will not be managed by Spring
2026-01-09 15:23:48.932 [tomcat-handler-17] DEBUG c.a.rag.mapper.ChunkMapper.findById - ==>  Preparing: SELECT id, resource_id, chunk_index, chunk_text, location_info, page_start, page_end, chapter_path, text_hash, vectorized, created_at FROM resource_chunks WHERE id = ?
2026-01-09 15:23:48.933 [tomcat-handler-17] DEBUG c.a.rag.mapper.ChunkMapper.findById - ==> Parameters: 548(Long)
2026-01-09 15:23:48.935 [tomcat-handler-17] DEBUG c.a.rag.mapper.ChunkMapper.findById - <==      Total: 1
2026-01-09 15:23:48.935 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@371ca09d]
2026-01-09 15:23:48.935 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:23:48.935 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ecde947] was not registered for synchronization because synchronization is not active
2026-01-09 15:23:48.935 [tomcat-handler-17] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@747091531 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will not be managed by Spring
2026-01-09 15:23:48.935 [tomcat-handler-17] DEBUG c.a.r.mapper.ResourceMapper.findById - ==>  Preparing: SELECT id, title, tags, file_type, file_path, file_size, description, content_hash, uploaded_by, upload_time, chunk_count, vectorized FROM resources WHERE id = ?
2026-01-09 15:23:48.935 [tomcat-handler-17] DEBUG c.a.r.mapper.ResourceMapper.findById - ==> Parameters: 5(Long)
2026-01-09 15:23:48.937 [tomcat-handler-17] DEBUG c.a.r.mapper.ResourceMapper.findById - <==      Total: 1
2026-01-09 15:23:48.937 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ecde947]
2026-01-09 15:23:48.937 [tomcat-handler-17] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'vector_search' completed in 10 ms
2026-01-09 15:23:48.937 [tomcat-handler-17] INFO  c.a.r.service.impl.SearchServiceImpl - 向量搜索完成，找到 1 个结果，总耗时 12ms（向量化 2ms，搜索 10ms）
2026-01-09 15:23:48.937 [tomcat-handler-17] DEBUG c.a.r.service.impl.SearchServiceImpl - 检索到 1 个切片，开始按资源聚合
2026-01-09 15:23:48.937 [tomcat-handler-17] INFO  c.a.r.service.impl.SearchServiceImpl - 聚合后的结果数量：1
2026-01-09 15:23:48.937 [tomcat-handler-17] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'retrieval' completed in 12 ms
2026-01-09 15:23:48.937 [tomcat-handler-17] DEBUG c.a.rag.service.impl.RagServiceImpl - 证据不足：检索结果数量 1 少于阈值 2
2026-01-09 15:23:48.937 [tomcat-handler-17] WARN  c.a.rag.service.impl.RagServiceImpl - 证据不足：userId=7, citationsCount=1, avgScore=0.386950433254
2026-01-09 15:23:48.937 [tomcat-handler-17] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'generation' completed in 0 ms
2026-01-09 15:23:48.939 [tomcat-handler-17] DEBUG c.a.r.s.impl.BehaviorServiceImpl - 记录用户查询行为: userId=7, queryText=什么是Javascript
2026-01-09 15:23:48.939 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:23:48.939 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7cc19809]
2026-01-09 15:23:48.939 [tomcat-handler-17] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@2087917320 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will be managed by Spring
2026-01-09 15:23:48.939 [tomcat-handler-17] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==>  Preparing: INSERT INTO user_behaviors ( user_id, behavior_type, resource_id, query_text, behavior_time, session_id, weight ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2026-01-09 15:23:48.939 [tomcat-handler-17] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==> Parameters: 7(Long), QUERY(String), null, 什么是Javascript(String), 2026-01-09 15:23:48.939096(Timestamp), null, null
2026-01-09 15:23:48.942 [tomcat-handler-17] DEBUG c.a.r.m.UserBehaviorMapper.insert - <==    Updates: 1
2026-01-09 15:23:48.942 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7cc19809]
2026-01-09 15:23:48.942 [tomcat-handler-17] INFO  c.a.r.s.impl.BehaviorServiceImpl - 查询行为已记录: behaviorId=62, userId=7
2026-01-09 15:23:48.942 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7cc19809]
2026-01-09 15:23:48.942 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7cc19809]
2026-01-09 15:23:48.942 [tomcat-handler-17] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7cc19809]
2026-01-09 15:23:48.946 [tomcat-handler-17] DEBUG c.a.rag.service.impl.RagServiceImpl - 查询行为记录成功：userId=7, query='什么是Javascript'
2026-01-09 15:23:48.946 [tomcat-handler-17] INFO  c.a.rag.service.impl.RagServiceImpl - 问答完成：userId=7, latencyMs=22ms, useRag=true, citationsCount=1
2026-01-09 15:23:48.947 [tomcat-handler-17] INFO  c.a.rag.controller.ChatController - RAG 问答完成：userId=7, latencyMs=22ms, evidenceInsufficient=true
2026-01-09 15:24:05.416 [tomcat-handler-18] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 15:24:05.417 [tomcat-handler-18] INFO  c.a.rag.controller.ChatController - POST /api/chat/ask - userId=7, question='什么是javascript', topK=5
2026-01-09 15:24:05.417 [tomcat-handler-18] INFO  c.a.rag.service.impl.RagServiceImpl - 执行问答：userId=7, question='什么是javascript', useRag=false, topK=5
2026-01-09 15:24:05.417 [tomcat-handler-18] INFO  c.a.rag.service.impl.RagServiceImpl - 纯 LLM 模式：跳过检索，直接调用 LLM
2026-01-09 15:24:05.417 [tomcat-handler-18] INFO  c.aetheris.rag.gateway.ChatGateway - 调用 Chat API（带系统提示）：model=glm-4-flash, systemPromptPreview=你是一个专业的学习助手，擅长回答各类学习相关问题。
请遵循以下要求：
1. 使用简洁清晰的语言回答问题
2. 如果遇到不确定的信息，明确说明
3. 避免添加不必要的主观推断
4. 回答应具有教育意义和实用性, userPromptPreview=什么是javascript
2026-01-09 15:24:05.418 [tomcat-handler-18] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://open.bigmodel.cn/api/paas/v4/chat/completions
- headers: [Authorization: Beare...4I], [Content-Type: application/json]
- body: {
  "model" : "glm-4-flash",
  "messages" : [ {
    "role" : "user",
    "content" : "[系统提示]你是一个专业的学习助手，擅长回答各类学习相关问题。\n请遵循以下要求：\n1. 使用简洁清晰的语言回答问题\n2. 如果遇到不确定的信息，明确说明\n3. 避免添加不必要的主观推断\n4. 回答应具有教育意义和实用性\n\n[用户问题]什么是javascript"
  } ],
  "stream" : false,
  "temperature" : 0.7,
  "top_p" : 0.9,
  "max_tokens" : 512,
  "stop" : [ ],
  "tool_choice" : "auto"
}

2026-01-09 15:24:12.324 [tomcat-handler-18] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [:status: 200], [content-type: application/json; charset=UTF-8], [date: Fri, 09 Jan 2026 07:24:12 GMT], [set-cookie: acw_tc=0aef815717679434457894092edf20f0091b029f6e3829480297fb0c02f444;path=/;HttpOnly;Max-Age=1800], [strict-transport-security: max-age=31536000; includeSubDomains], [vary: [Accept-Encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers, Origin, Access-Control-Request-Method, Access-Control-Request-Headers]], [x-log-id: 20260109152405a4a50094d43d4632]
- body: {"choices":[{"finish_reason":"stop","index":0,"message":{"content":"JavaScript是一种广泛使用的编程语言，主要用于网页开发中实现交互功能。它允许网页在不刷新页面的情况下与用户进行交互，是构成动态和交互式网页的关键技术之一。\n\n主要特点包括：\n\n1. **客户端脚本语言**：JavaScript主要在用户浏览器中执行，不需要服务器支持。\n2. **事件驱动**：JavaScript响应网页上的事件，如鼠标点击、键盘输入等。\n3. **嵌入HTML**：可以直接嵌入HTML文档中，无需额外安装。\n4. **跨平台性**：几乎所有的现代浏览器都支持JavaScript。\n5. **丰富的库和框架**：如jQuery、React、Vue等，简化了开发过程。\n\nJavaScript在网页开发中主要用于以下方面：\n\n- **DOM操作**：文档对象模型（DOM）操作，允许JavaScript动态改变网页内容。\n- **表单验证**：在客户端验证用户输入的数据。\n- **动画和特效**：实现网页上的动态效果和动画。\n- **AJAX**：允许网页在不刷新页面的情况下与服务器交换数据。\n\n学习JavaScript有助于掌握网页设计和开发，是前端开发的基础技能之一。","role":"assistant"}}],"created":1767943452,"id":"20260109152405a4a50094d43d4632","model":"glm-4-flash","object":"chat.completion","request_id":"20260109152405a4a50094d43d4632","usage":{"completion_tokens":233,"prompt_tokens":74,"total_tokens":307}}

2026-01-09 15:24:12.325 [tomcat-handler-18] INFO  c.a.rag.service.impl.RagServiceImpl - LLM 直接生成答案成功：userId=7, answerLength=502
2026-01-09 15:24:12.325 [tomcat-handler-18] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'generation' completed in 6907 ms
2026-01-09 15:24:12.329 [tomcat-handler-18] DEBUG c.a.r.s.impl.BehaviorServiceImpl - 记录用户查询行为: userId=7, queryText=什么是javascript
2026-01-09 15:24:12.329 [tomcat-handler-18] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:24:12.330 [tomcat-handler-18] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6c571b4a]
2026-01-09 15:24:12.330 [tomcat-handler-18] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@341661833 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will be managed by Spring
2026-01-09 15:24:12.330 [tomcat-handler-18] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==>  Preparing: INSERT INTO user_behaviors ( user_id, behavior_type, resource_id, query_text, behavior_time, session_id, weight ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2026-01-09 15:24:12.330 [tomcat-handler-18] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==> Parameters: 7(Long), QUERY(String), null, 什么是javascript(String), 2026-01-09 15:24:12.329944(Timestamp), null, null
2026-01-09 15:24:12.333 [tomcat-handler-18] DEBUG c.a.r.m.UserBehaviorMapper.insert - <==    Updates: 1
2026-01-09 15:24:12.334 [tomcat-handler-18] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6c571b4a]
2026-01-09 15:24:12.334 [tomcat-handler-18] INFO  c.a.r.s.impl.BehaviorServiceImpl - 查询行为已记录: behaviorId=63, userId=7
2026-01-09 15:24:12.334 [tomcat-handler-18] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6c571b4a]
2026-01-09 15:24:12.334 [tomcat-handler-18] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6c571b4a]
2026-01-09 15:24:12.334 [tomcat-handler-18] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6c571b4a]
2026-01-09 15:24:12.338 [tomcat-handler-18] DEBUG c.a.rag.service.impl.RagServiceImpl - 查询行为记录成功：userId=7, query='什么是javascript'
2026-01-09 15:24:12.338 [tomcat-handler-18] INFO  c.a.rag.service.impl.RagServiceImpl - 问答完成：userId=7, latencyMs=6920ms, useRag=false, citationsCount=0
2026-01-09 15:24:12.338 [tomcat-handler-18] INFO  c.a.rag.controller.ChatController - RAG 问答完成：userId=7, latencyMs=6920ms, evidenceInsufficient=false
2026-01-09 15:24:24.871 [tomcat-handler-19] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 15:24:24.872 [tomcat-handler-19] INFO  c.a.rag.controller.ChatController - POST /api/chat/ask - userId=7, question='什么是java', topK=5
2026-01-09 15:24:24.872 [tomcat-handler-19] INFO  c.a.rag.service.impl.RagServiceImpl - 执行问答：userId=7, question='什么是java', useRag=false, topK=5
2026-01-09 15:24:24.872 [tomcat-handler-19] INFO  c.a.rag.service.impl.RagServiceImpl - 纯 LLM 模式：跳过检索，直接调用 LLM
2026-01-09 15:24:24.872 [tomcat-handler-19] INFO  c.aetheris.rag.gateway.ChatGateway - 调用 Chat API（带系统提示）：model=glm-4-flash, systemPromptPreview=你是一个专业的学习助手，擅长回答各类学习相关问题。
请遵循以下要求：
1. 使用简洁清晰的语言回答问题
2. 如果遇到不确定的信息，明确说明
3. 避免添加不必要的主观推断
4. 回答应具有教育意义和实用性, userPromptPreview=什么是java
2026-01-09 15:24:24.873 [tomcat-handler-19] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://open.bigmodel.cn/api/paas/v4/chat/completions
- headers: [Authorization: Beare...qo], [Content-Type: application/json]
- body: {
  "model" : "glm-4-flash",
  "messages" : [ {
    "role" : "user",
    "content" : "[系统提示]你是一个专业的学习助手，擅长回答各类学习相关问题。\n请遵循以下要求：\n1. 使用简洁清晰的语言回答问题\n2. 如果遇到不确定的信息，明确说明\n3. 避免添加不必要的主观推断\n4. 回答应具有教育意义和实用性\n\n[用户问题]什么是java"
  } ],
  "stream" : false,
  "temperature" : 0.7,
  "top_p" : 0.9,
  "max_tokens" : 512,
  "stop" : [ ],
  "tool_choice" : "auto"
}

2026-01-09 15:24:31.243 [tomcat-handler-19] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [:status: 200], [content-type: application/json; charset=UTF-8], [date: Fri, 09 Jan 2026 07:24:31 GMT], [set-cookie: acw_tc=0aef815717679434649795765edf20a8cae284bbe5f227b30069f82cfb6cc1;path=/;HttpOnly;Max-Age=1800], [strict-transport-security: max-age=31536000; includeSubDomains], [vary: [Accept-Encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers, Origin, Access-Control-Request-Method, Access-Control-Request-Headers]], [x-log-id: 2026010915242491502ed840cd4e16]
- body: {"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Java是一种广泛使用的计算机编程语言，由Sun Microsystems公司（现已被甲骨文公司收购）于1995年推出。Java具有“一次编写，到处运行”的特点，这意味着编写好的Java程序可以在支持Java虚拟机（JVM）的任何平台上运行，无需修改源代码。\n\n主要特点包括：\n\n1. **面向对象**：Java是一种面向对象的编程语言，这意味着它支持将数据和行为封装在对象中。\n2. **平台无关性**：Java程序通过编译成字节码，然后在任何支持JVM的平台上运行，实现了跨平台性。\n3. **安全性**：Java提供了许多安全特性，如沙箱模型，以防止恶意代码对系统造成损害。\n4. **简单性**：Java设计时考虑了易学易用，语法相对简单。\n5. **多线程**：Java内置了多线程支持，使得程序可以同时执行多个任务。\n\nJava广泛应用于企业级应用、Android应用开发、大数据处理、网络编程等多个领域。学习Java对于从事计算机科学相关领域的工作非常有帮助。","role":"assistant"}}],"created":1767943471,"id":"2026010915242491502ed840cd4e16","model":"glm-4-flash","object":"chat.completion","request_id":"2026010915242491502ed840cd4e16","usage":{"completion_tokens":221,"prompt_tokens":74,"total_tokens":295}}

2026-01-09 15:24:31.243 [tomcat-handler-19] INFO  c.a.rag.service.impl.RagServiceImpl - LLM 直接生成答案成功：userId=7, answerLength=437
2026-01-09 15:24:31.243 [tomcat-handler-19] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'generation' completed in 6371 ms
2026-01-09 15:24:31.247 [tomcat-handler-19] DEBUG c.a.r.s.impl.BehaviorServiceImpl - 记录用户查询行为: userId=7, queryText=什么是java
2026-01-09 15:24:31.247 [tomcat-handler-19] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:24:31.247 [tomcat-handler-19] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e8f83f8]
2026-01-09 15:24:31.247 [tomcat-handler-19] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@1452562123 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will be managed by Spring
2026-01-09 15:24:31.247 [tomcat-handler-19] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==>  Preparing: INSERT INTO user_behaviors ( user_id, behavior_type, resource_id, query_text, behavior_time, session_id, weight ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2026-01-09 15:24:31.248 [tomcat-handler-19] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==> Parameters: 7(Long), QUERY(String), null, 什么是java(String), 2026-01-09 15:24:31.247533(Timestamp), null, null
2026-01-09 15:24:31.251 [tomcat-handler-19] DEBUG c.a.r.m.UserBehaviorMapper.insert - <==    Updates: 1
2026-01-09 15:24:31.251 [tomcat-handler-19] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e8f83f8]
2026-01-09 15:24:31.251 [tomcat-handler-19] INFO  c.a.r.s.impl.BehaviorServiceImpl - 查询行为已记录: behaviorId=64, userId=7
2026-01-09 15:24:31.251 [tomcat-handler-19] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e8f83f8]
2026-01-09 15:24:31.252 [tomcat-handler-19] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e8f83f8]
2026-01-09 15:24:31.252 [tomcat-handler-19] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e8f83f8]
2026-01-09 15:24:31.255 [tomcat-handler-19] DEBUG c.a.rag.service.impl.RagServiceImpl - 查询行为记录成功：userId=7, query='什么是java'
2026-01-09 15:24:31.255 [tomcat-handler-19] INFO  c.a.rag.service.impl.RagServiceImpl - 问答完成：userId=7, latencyMs=6383ms, useRag=false, citationsCount=0
2026-01-09 15:24:31.255 [tomcat-handler-19] INFO  c.a.rag.controller.ChatController - RAG 问答完成：userId=7, latencyMs=6383ms, evidenceInsufficient=false
2026-01-09 15:25:52.635 [tomcat-handler-20] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 15:25:52.636 [tomcat-handler-20] INFO  c.a.rag.controller.ChatController - POST /api/chat/ask - userId=7, question='什么是java', topK=5
2026-01-09 15:25:52.636 [tomcat-handler-20] INFO  c.a.rag.service.impl.RagServiceImpl - 执行问答：userId=7, question='什么是java', useRag=true, topK=5
2026-01-09 15:25:52.636 [tomcat-handler-20] INFO  c.a.r.service.impl.SearchServiceImpl - 执行聚合语义检索：query='什么是java', topK=5
2026-01-09 15:25:52.636 [tomcat-handler-20] INFO  c.a.r.service.impl.SearchServiceImpl - 执行语义检索：query='什么是java', topK=10
2026-01-09 15:25:52.638 [tomcat-handler-20] DEBUG c.a.rag.gateway.cache.EmbeddingCache - Embedding cache miss for textHash: 5eab67cd79781e9f59cc2239ded10d7d545b2e9a5814e9b08f7264743b8601e5
2026-01-09 15:25:52.638 [tomcat-handler-20] INFO  c.a.rag.gateway.EmbeddingGateway - 调用 Embedding API：model=embedding-3, textPreview=什么是java
2026-01-09 15:25:52.643 [tomcat-handler-20] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://open.bigmodel.cn/api/paas/v4/embeddings
- headers: [Authorization: Beare...Fw], [Content-Type: application/json]
- body: {
  "input" : "什么是java",
  "model" : "embedding-3"
}

2026-01-09 15:25:54.229 [tomcat-handler-20] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [:status: 200], [content-type: application/json; charset=UTF-8], [date: Fri, 09 Jan 2026 07:25:54 GMT], [set-cookie: acw_tc=0aef82d717679435540106206efec7670f1f24a18d527ecda7e1ef1a7cfd31;path=/;HttpOnly;Max-Age=1800], [strict-transport-security: max-age=31536000; includeSubDomains], [vary: [Accept-Encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers, Origin, Access-Control-Request-Method, Access-Control-Request-Headers]], [x-log-id: 202601091525541955b93660794c78]
- body: {"data":[{"embedding":[0.0026066604,-0.0040454953,0.0073840106,0.004972424,-0.017711151,0.014223385,-0.0051635704,0.014893706,-0.00052990747,-0.001860404,0.017355043,0.006525161,0.03401882,-0.008180018,-0.0006035512,0.011803943,0.037307583,0.0032704358,-0.024194418,-0.023126092,0.026750019,0.00022404056,-0.01204484,0.031965956,-0.005708207,0.0023932573,0.0136682745,-0.0020031093,-0.0061795264,-0.016548563,0.014977496,0.09350985,-0.029515095,-0.017533097,-0.019994434,0.026414858,-0.0029195645,-0.04457638,0.020109646,0.020434333,0.017271252,0.001048032,-0.011060305,-0.049268633,0.019376481,0.0013386792,0.0029483673,0.0076720393,-0.022811878,0.044702068,-0.00011578429,0.004776041,0.005367809,0.006792242,0.011343097,-0.015815398,0.016611405,0.022644298,0.0099239005,-0.011343097,-0.0030976185,-0.01014385,-0.00649374,0.0009040176,0.0034511085,0.03108616,-0.012400948,-0.029850256,-0.0036893869,0.009971033,0.009871531,0.009311185,-0.024361998,0.046922505,0.049394317,0.023943046,0.017773993,0.025241794,0.020947548,0.016695196,0.0009046722,-0.01229621,0.02272809,0.008651337,-0.00032485064,-0.023251778,0.019565009,0.008724653,0.036008835,0.004228786,0.012809426,0.025723588,0.011479256,0.0099815065,0.026456753,-0.004925292,-0.05613943,0.017187463,-0.020486701,-0.02203682,-0.020308647,0.022392929,0.029138038,0.013940593,-0.0046686847,0.0024063494,0.0044016032,-0.012966532,0.015270762,0.0027022336,-0.06242369,-0.050441694,0.049729478,0.009677767,0.018088207,-0.0006133704,0.003786269,-0.02631012,0.024885686,-0.0063104485,-0.0018734962,0.0030033546,0.026037801,-0.0015854675,0.008845102,-0.0029326566,-0.018852793,-0.023251778,0.021827344,0.008038621,0.03441682,-0.024550525,0.038480643,-0.013144586,0.016695196,-0.011856312,-0.0015749937,0.039046228,0.019690694,-0.0018041076,-0.003537517,0.005881024,0.029577937,-0.02742034,0.0019258652,-0.14814106,-0.005875787,0.0019206282,-0.011604941,-0.004168562,-0.016579984,0.0062737903,0.015920136,-0.008054332,-0.041538987,-0.039737497,-0.044366907,-0.005561574,0.016642826,0.027713606,-0.06740921,-0.00188397,0.022057768,0.009342606,0.038292117,-0.010808934,0.027315602,0.011301202,0.011248833,-0.031379428,-0.016380982,-0.01828721,0.030876685,-0.029410357,0.015951557,0.031735536,0.019418376,-0.023712624,0.006855085,-0.012411422,-0.0008693232,0.0028410112,-0.0016470009,0.010892725,-0.017218884,-0.014495702,-0.020235332,-0.012505686,0.047173876,0.02042386,0.021293182,-0.002244006,-0.009850584,-0.008169544,-0.0101281395,-0.04415743,-0.011510678,0.028907616,0.0039355205,0.01498797,0.0024534815,0.00027837328,0.0071431138,-0.031358477,0.00619,0.026289172,0.034668192,0.011028884,0.0018041076,0.010662301,0.00078946067,-0.018224366,0.0150822345,0.0036003597,0.014548072,0.011845838,0.01212863,0.005839129,0.012065787,-0.011762048,-0.013919645,-0.033180915,-0.023021355,0.02417347,-0.018381473,-0.010274772,-0.00096227793,0.002331724,0.04721577,0.05270403,0.025807379,-0.008221912,0.01307127,-0.039946973,-0.0025490546,-0.0022309138,0.01298748,0.010170034,-0.04348711,0.015752556,-0.01371017,-0.009798216,-0.018297683,-0.0011076016,-0.006807953,0.008447099,0.01717699,0.02980836,0.010997462,0.004008837,-0.034186397,-0.019355534,0.017051304,0.009175026,-0.018779477,0.0027493655,0.054966364,-0.038815804,-0.0251999,0.026791913,0.039737497,0.015417395,-0.013574011,0.009264053,-0.009248342,-0.015385973,-0.0102171665,-0.011133621,0.0040114555,-0.052117497,-0.01934506,0.01948122,0.018161524,-0.01165731,0.0135216415,0.0026066604,-0.0071535874,0.025954012,-0.0021052286,0.054296043,-0.009122657,-0.0044487356,-0.013636854,0.020727599,-0.011814416,0.017543571,0.018978478,0.0043361424,0.010840355,0.005781523,-0.030876685,0.0128722675,-0.006839374,0.0043361424,-0.019376481,0.022644298,0.023712624,0.017323622,0.050860643,0.01285132,0.024843791,0.0026616477,0.009154079,-0.01767973,0.00960445,-0.035925046,0.0063628177,0.008190491,0.014673757,0.014485229,-0.025786432,0.00007245724,0.02178545,-0.007363063,-0.000023852383,0.046503555,-0.011039358,-0.0038517304,-0.010829882,-0.005823418,-0.0014440715,-0.035589885,-0.0065094503,0.04621029,-0.0025529824,0.006389002,-0.015155551,-0.02767171,0.012170525,-0.0088032065,-0.0097458465,-0.00289338,-0.011751574,-0.019638326,-0.025409374,0.01870616,-0.017658783,0.005462073,0.0028907615,-0.010489484,-0.0010369036,0.0025961867,0.025849273,-0.0010670157,0.025807379,-0.01285132,-0.019837327,0.04621029,0.0040952456,-0.011709679,-0.007865804,-0.030101625,-0.010787987,-0.00058685866,-0.035401355,-0.008310939,-0.02783929,-0.020256279,0.017941574,-0.038669173,0.009075525,-0.016077243,0.0054463623,-0.03295049,0.01995254,0.0067451103,-0.012977006,0.028425822,0.019617379,-0.016684722,0.039234757,-0.008693232,-0.038627278,-0.03441682,-0.007912936,-0.016129611,0.0011612796,0.009295474,-0.021031337,0.0202877,0.004595368,0.00081826356,-0.02006775,-0.009085999,-0.021261761,-0.019156532,-0.0027362735,0.013898698,-0.015825871,-0.0010185745,0.0025346533,0.021125602,-0.010337614,0.011374518,-0.010725144,-0.005739628,0.021408394,-0.0066875047,-0.22422254,-0.012956058,-0.011437361,-0.0047681853,-0.020277226,-0.0075673014,-0.020769494,0.0073316414,-0.0023880205,-0.00049946806,0.00013869567,0.03424924,0.019931592,0.010091481,-0.01981638,-0.002244006,0.0023487438,-0.0053520985,0.0038360197,0.017082725,-0.00034727107,0.014275754,-0.009112183,0.011510678,-0.014883232,-0.013312167,-0.0049174367,-0.009122657,0.016349562,0.00094263966,-0.0006336633,-0.006195237,0.026435805,0.018182471,-0.020078225,0.04179036,0.0028253004,-0.0031159476,-0.0006807953,0.025137058,0.004776041,-0.020811388,0.012222894,0.00034465262,0.051028226,0.0013498076,0.039255705,0.0065984773,-0.012757056,-0.0014663283,-0.0328667,-0.013752065,0.0028829062,0.0035767937,0.00952066,-0.0056715487,-0.016726617,0.038396854,-0.025597904,0.00024056948,0.028404875,0.039004333,-0.008164306,-0.016202928,0.18232745,-0.01157352,0.004742001,0.0076039596,-0.014883232,-0.013898698,-0.007572538,0.0015854675,-0.007912936,0.035925046,0.0032678174,-0.007493985,-0.020109646,0.009735373,-0.010861304,0.034605347,-0.013113164,0.019146059,0.032175433,-0.012065787,0.018381473,0.024403892,0.010300957,-0.03152606,0.0064151864,0.026666228,0.032259222,-0.019292692,0.019418376,0.011374518,0.03741232,-0.0089498395,-0.012798952,0.017365517,-0.014663283,-0.019575482,0.021743555,0.007897225,-0.0018931346,0.0435709,0.0006107519,-0.0049514766,-0.0033385153,-0.010840355,-0.0011796087,-0.009394975,0.0072373776,-0.009154079,-0.010945094,0.02272809,0.016611405,0.045079123,0.010568038,-0.010101954,-0.010620407,0.032678176,-0.008483756,-0.0014296701,0.050022744,-0.030751,-0.018549053,0.010829882,-0.004611079,0.0025346533,0.00041076832,-0.011301202,0.0084785195,-0.0013079125,0.004042877,-0.013029374,0.007268799,-0.01507176,-0.003071434,0.023356516,0.032070696,-0.017428359,0.011028884,-0.005202847,0.009950085,0.0021353406,-0.004008837,-0.018779477,0.025158005,0.01673709,0.0025084687,-0.03401882,-0.0101595605,0.0032678174,-0.026247278,0.008415678,-0.0012201946,-0.013186481,-0.004503723,-0.0009020538,0.0059438664,0.000042099662,0.018255787,-0.015773503,-0.005881024,0.022057768,0.030269206,-0.008782259,-0.019837327,-0.020340068,-0.0076458547,-0.006860322,0.02400589,0.008986498,0.02664528,-0.033348497,-0.035149984,-0.01687325,-0.029033301,-0.028279189,-0.019502167,-0.0026969968,-0.008316176,0.018664265,0.06208853,0.006153342,-0.032782912,0.009002209,-0.0021157023,0.01815105,-0.02894951,-0.0202877,-0.015354552,0.007027902,0.017616887,0.0076039596,0.038711067,0.024131574,0.0064623184,0.008164306,-0.015951557,0.0435709,0.001313804,0.054421727,0.013060796,-0.035673674,-0.00514786,0.025430322,-0.019376481,0.0024835935,0.0055511002,0.030730052,-0.025095161,-0.014024383,-0.020465754,-0.0015671384,-0.0058705504,0.0074101947,0.0072897463,0.0051164385,-0.042230256,0.017229358,-0.03491956,0.004338761,0.01340643,0.03443777,-0.017952047,-0.014925128,0.010185745,-0.030457733,-0.0016312903,-0.0067608207,0.001736028,0.008818918,0.0025411993,-0.0036396363,0.022665245,-0.011175517,0.014453808,0.0008143359,-0.018444316,0.0006156615,0.019565009,-0.006389002,-0.032238275,0.007975779,-0.028488664,0.023922099,0.011699205,-0.008180018,-0.000301121,0.0052761636,-0.024822844,0.022476718,0.021806397,0.03408166,0.0034563453,-0.002449554,0.02570264,0.009635872,-0.04302626,0.005215939,0.0009910809,-0.011144095,0.026498647,0.046587344,0.03774748,0.0005053596,-0.013123639,-0.013060796,0.009782504,-0.038250223,-0.011060305,-0.034731034,0.0034772928,0.019544061,0.0046739215,-0.011992471,-0.044953436,-0.006210948,0.015040339,-0.014558545,-0.021125602,0.033935025,-0.033641763,-0.025828326,0.0055877585,0.00041338676,0.034668192,0.019083215,0.017585466,-0.024822844,0.009264053,0.0034982404,0.0056348904,0.012338106,0.009871531,-0.0050614513,-0.0018826608,0.009918664,0.020633334,-0.026791913,0.0020829719,-0.0050954907,0.0358622,-0.017773993,0.04918484,-0.011165042,-0.02972457,-0.013228376,0.00602242,0.015061286,-0.032594383,0.024215365,-0.0044434983,0.011154569,0.018360525,-0.006430897,0.021408394,0.074782744,0.002964078,0.01554308,-0.010007691,-0.03732853,-0.03401882,0.028719088,-0.030038783,-0.041392352,-0.04124572,0.028865721,0.010892725,-0.023272725,0.0125475805,-0.016223876,0.0003222322,-0.021136075,-0.0134588,-0.00467654,-0.0049514766,0.0011907371,-0.004257589,-0.017972996,0.015312657,-0.02356599,0.033034284,-0.018894687,-0.012924637,0.007886752,-0.015385973,0.054756887,-0.008651337,-0.04246068,-0.034186397,0.037852217,-0.029703623,0.0014362162,-0.032741018,0.027818343,-0.038983386,-0.004249734,0.0057710493,-0.008494231,-0.025681693,0.021240814,0.0032259224,0.0014309793,0.01853858,-0.005645364,0.0032206855,0.017753046,0.0103952205,-0.010206693,-0.011615415,0.0016430733,0.02289567,0.02545127,0.0058914977,0.015008918,-0.015867768,0.009101709,-0.03971655,-0.026938546,-0.011500204,0.0030452497,0.045121018,0.033453234,-0.0076249074,-0.027944028,-0.025325585,0.0024757383,-0.0027860238,-0.016663775,-0.0060381307,0.03144227,0.022665245,-0.013773013,-0.012348579,0.045079123,0.048640206,0.012956058,0.016045822,-0.0006755584,0.030248258,0.015731608,-0.008777022,0.0013203501,-0.016841829,-0.009405449,-0.01759594,0.0030216838,-0.014380491,-0.020916127,-0.018213892,0.0065408717,0.052494556,0.018601421,0.043529004,0.017218884,-0.030373944,0.018224366,0.0056663114,0.0023330331,0.041916043,0.0011815726,-0.006949349,-0.031965956,-0.038396854,-0.00625808,0.02503232,-0.03883675,-0.029850256,0.02104181,-0.0035532278,0.007939121,0.009719662,0.03774748,0.01690467,0.015239341,-0.019774485,0.043529004,-0.03535946,0.017554045,-0.05115391,-0.037098106,0.0051216753,-0.039674655,-0.013856803,-0.028069714,-0.011866786,0.008195728,0.01061517,0.023628833,-0.018475737,-0.053416245,-0.005791997,-0.017082725,-0.0043309056,0.0074259057,0.0106308805,0.0039643236,0.025891168,-0.027881186,0.00999198,0.013249324,-0.036846735,0.016998935,0.01323885,-0.01700941,-0.0007953522,0.030960476,-0.035736516,-0.012882742,-0.0133435875,-0.01246379,-0.007839619,-0.013741591,-0.0076563284,-0.000010811307,0.009374027,0.05404467,0.011583994,0.013752065,-0.0069702966,-0.044031743,0.026980441,-0.012725635,0.010520905,-0.000277555,-0.0095101865,0.011322149,-0.0057186806,-0.011227885,-0.00950495,-0.025891168,0.0066927415,0.004417314,-0.001313804,-0.02059144,0.027546026,-0.008640863,-0.011552572,-0.01204484,-0.021932082,0.0037339004,-0.031798378,0.007598723,0.011217412,-0.015867768,0.007075034,0.005692496,0.017197937,0.024047785,0.03322281,0.011908681,0.0060433676,-0.006205711,0.010049586,-0.0008712871,0.0018499303,0.021146549,0.010253824,0.013982488,-0.0100705335,0.024131574,-0.005582521,0.0052473606,-0.007996726,0.013364535,0.0155849755,0.024822844,-0.016548563,0.0029378936,0.005098109,0.0059491033,-0.0038045982,-0.020832336,0.029850256,0.004042877,0.006148105,-0.038292117,0.009457817,0.05417036,-0.028300136,0.0040062186,0.0029326566,-0.011824891,-0.010154324,0.000052982567,-0.0028907615,-0.0032809097,-0.03808264,-0.029305618,-0.003076671,-0.03171459,-0.017700678,0.08605252,-0.020497175,-0.03982129,-0.004954095,0.048053674,0.015239341,0.019638326,0.0070645604,-0.00990819,-0.05006464,-0.013217903,0.0037339004,0.0025700023,-0.003584649,0.00072596344,-0.00619,0.026896652,0.028069714,0.062214214,-0.011238359,-0.02708518,-0.00062384416,-0.01948122,-0.013060796,-0.0028122081,0.018517632,-0.0020057277,0.000746911,-0.0062161847,0.016161032,0.0066717938,-0.008923655,-0.0104633,0.011123148,0.0024521723,0.01717699,-0.012400948,-0.011730626,0.023691677,-0.00012241222,0.018245313,0.021932082,0.0065984773,-0.03854349,0.017218884,0.028090661,-0.01545929,-0.022330085,-0.0025621469,0.02664528,0.01285132,0.0269176,-0.0016103428,-0.015019392,-0.011196464,-0.004854594,-0.009735373,0.01767973,0.019701168,0.031169951,-0.010101954,-0.0066508465,0.002037149,-0.009044103,0.020381963,-0.015354552,-0.025912115,0.024320103,0.040784873,0.026372962,0.02356599,-0.009080762,0.025493165,0.012306684,-0.015207919,-0.022518614,-0.005907208,-0.020570492,0.02459242,0.008080516,-0.018643318,-0.015312657,-0.012484739,0.0070645604,-0.0023408884,-0.018465264,0.0067294,-0.020203909,-0.019083215,-0.044869646,0.0007757139,0.0074101947,0.0019468127,0.0026079696,-0.03228017,-0.0071902457,-0.009195973,-0.00006746583,-0.027776448,0.04218836,0.03653252,-0.039695602,-0.021827344,0.0035872676,-0.0069336384,-0.0026354634,0.00053874473,0.002183782,0.019502167,0.020601913,0.017386464,0.0071954825,-0.0031499874,0.0333066,-0.010840355,-0.03244775,0.011971523,-0.017082725,-0.0051242937,-0.013448326,0.0019599048,0.015396447,0.012160052,-0.0088608125,-0.014212911,0.026058748,0.029745517,0.010201456,0.010808934,-0.004516815,0.021659764,0.016464772,0.01268374,-0.004566565,-0.01823484,-0.0039905077,0.011510678,0.060370833,0.033097126,0.0088032065,-0.012641845,0.008735128,0.00029473854,-0.025807379,-0.03219638,-0.0020450044,0.026268225,0.02070665,0.015040339,0.01776352,-0.031274687,0.016391456,-0.014998444,0.011405939,-0.008918419,0.007441616,0.047802303,-0.03699337,0.0015920136,0.039318547,0.0025372717,0.015166025,0.018203419,0.010426641,0.02836298,0.005818181,-0.009614924,0.0091278935,0.00079862523,-0.0104528265,-0.009164552,0.031567954,-0.047634725,-0.016297191,0.020193435,-0.00049063086,-0.0251999,-0.007729645,0.0012450699,0.029075196,-0.003932902,-0.016548563,0.009766794,-0.037307583,-0.028593402,-0.004097864,-0.02450863,0.010510432,-0.03680484,-0.021366498,0.029242776,0.049394317,0.022749037,0.017407412,-0.041476145,0.0060381307,0.018727107,-0.0041607064,-0.016621878,0.008777022,-0.017962523,0.026163487,0.015658291,-0.0093321325,0.022539562,0.014370018,-0.0014846574,-0.018046312,-0.015291709,0.011510678,0.0029038538,0.00035152602,0.02989215,0.017239831,-0.017470255,-0.00073185493,-0.036846735,-0.011269781,0.011793469,0.006860322,-0.01285132,0.025325585,0.016276244,0.008735128,0.01022764,-0.011542099,0.010149087,-0.022078715,0.0160144,-0.008316176,-0.0071588242,0.0025844036,0.010002454,0.01767973,0.020224856,0.02087423,0.023419358,0.034060713,-0.015155551,0.019146059,-0.012893216,-0.037391372,-0.03083479,0.0094525805,0.011091727,-0.014569019,0.0073264046,0.0053442433,0.010526143,0.039339494,-0.0094211595,0.0007783323,0.011133621,-0.0020515504,-0.0019167006,-0.0045220517,0.01700941,0.02262335,0.010369036,0.0016273626,-0.023922099,-0.031882167,0.01362638,-0.006708452,0.02476,0.017334096,-0.013060796,-0.027818343,-0.017250305,0.00049095816,-0.0039355205,-0.0043256683,0.019167006,0.029515095,0.0014833482,-0.023126092,-0.018999426,0.014684231,0.02878193,-0.040344976,0.038480643,0.02681286,0.02356599,-0.022162504,-0.06389002,-0.016003925,0.01307127,-0.021973977,-0.010054823,0.03910907,0.0021013007,0.008588495,-0.018004417,0.062381797,0.019722115,0.017826363,0.0033385153,-0.032636277,-0.016642826,0.00913313,0.03982129,0.004055969,0.025618851,0.016003925,0.028719088,0.009902953,-0.006519924,0.016998935,0.02476,0.033013336,0.0046503553,0.0069964807,0.019596431,0.02597496,0.01251616,-0.005472547,0.0019350298,0.02289567,-0.026770966,-0.015448816,0.0038045982,0.016517142,-0.023105145,0.009855821,0.018800424,0.030876685,-0.024026837,0.008342361,-0.011290728,-0.029284671,-0.012369527,0.011563046,0.0020829719,0.023754518,0.0009020538,-0.012421896,-0.017417885,0.011091727,0.032259222,0.008976024,0.0030216838,-0.01545929,0.019701168,0.00084706646,-0.018255787,-0.010520905,-0.010882251,0.01926127,0.050148427,0.004359708,0.014055804,0.008766549,-0.03033205,0.0036658207,-0.0053154402,-0.023188936,0.0050823987,-0.00952066,-0.0056558377,-0.020989442,0.007881515,0.009091236,0.026666228,0.010746092,-0.036092624,0.013563537,0.003524425,-0.0264777,0.0008346288,0.019669747,0.011165042,-0.009614924,-0.0034589637,-0.005456836,-0.02070665,-0.031232793,-0.0015566646,-0.011133621,0.00984011,0.056265112,0.02203682,0.011762048,-0.034207344,0.004021929,-0.016799932,0.0013707551,-0.026791913,0.012097209,0.019428851,-0.021848291,-0.00038916615,0.008483756,0.0040664426,-0.008358072,0.033453234,0.01853858,0.032405857,-0.0024822843,-0.011961049,-0.02323083,0.021073233,0.0036972421,-0.027797395,0.015752556,0.0032809097,0.03339039,0.015239341,0.0024600276,-0.029577937,0.020434333,-0.014663283,-0.00312904,0.014527124,0.0011180753,0.014998444,0.0006208984,-0.009075525,-0.0013707551,-0.00713264,0.011384992,-0.009415923,0.004734146,-0.003773177,0.012065787,0.025095161,0.02681286,-0.009431633,0.004173799,0.034982406,-0.008504705,-0.028719088,-0.01806726,-0.00777154,-0.006231895,-0.0059805247,-0.009085999,-0.0017268634,-0.0011049832,-0.006703215,0.014851811,0.00028066442,0.007776777,0.0049933717,0.010966041,-0.02459242,0.03938139,0.0062842644,-0.022246296,-0.040596347,-0.007640618,-0.033432286,0.011961049,-0.012275263,-0.018517632,-0.0025817852,0.015291709,0.009154079,-0.020329595,-0.012013419,-0.009761557,0.03571557,-0.008017674,0.06414139,0.027336549,0.008483756,-0.0044958675,0.031190898,-0.012180999,0.019669747,-0.004671303,0.00091580057,-0.01323885,0.03408166,0.0026197527,0.013657801,0.036867682,-0.00038425656,-0.012631371,0.002898617,0.06485361,-0.020162014,-0.0036632023,0.0093321325,-0.0026184435,-0.0036396363,0.018999426,0.029598884,-0.04801178,-0.0111022005,-0.0002678995,0.017794942,0.012798952,-0.0035427539,-0.022204401,-0.0071588242,0.08898518,-0.006169053,-0.016957039,0.023042303,-0.0144642815,0.033955973,0.024676211,0.005886261,0.0038150721,0.023901151,0.014474755,-0.018988952,0.02476,0.04302626,-0.00018820062,-0.0032809097,-0.011709679,-0.02272809,-0.011636362,0.026372962,0.011353571,0.0072321407,-0.03204975,-0.01873758,-0.0014335978,0.009614924,0.048556414,0.033516075,0.0012856558,-0.035799358,0.023922099,-0.0018630225,-0.028258242,0.029996889,-0.0009917355,-0.012065787,0.0031787902,-0.013783487,0.017543571,-0.009023156,0.011028884,0.02459242,0.010374273,-0.031819325,-0.02664528,-0.0021091562,-0.0075201695,-0.014401439,-0.03672105,0.022707142,-0.033432286,0.007881515,-0.01690467,-0.015941083,0.013039848,0.009693477,0.0033044757,0.029431304,0.011845838,-0.017030356,0.0026943784,0.021596922,-0.018308157,-0.0028331557,-0.006389002,-0.008028148,0.008934129,0.023545044,-0.0021785449,0.03253154,0.0030845264,0.044785857,-0.0030007362,-0.014736599,-0.01596203,0.000036596837,-0.022267243,0.013008427,-0.026037801,0.008405203,0.013427378,0.0018931346,-0.00063595443,-0.023922099,-0.036679156,0.00017903607,0.008661811,0.012086735,-0.01076704,-0.0648955,-0.02306325,-0.008431388,0.052410763,-0.009253579,-0.021450289,0.03380934,-0.021303656,-0.0209266,-0.0067294,-0.017658783,0.0014283609,0.020738073,0.037768427,0.01720841,-0.02262335,0.014401439,-0.032154486,-0.00006992062,0.005509205,-0.031547006,0.024110626,-0.0632197,0.027818343,0.017334096,0.022560509,-0.021575974,0.019156532,-0.0027938792,0.01653809,-0.015773503,-0.00027640944,-0.0068917433,0.0064361338,-0.040407818,0.005009082,-0.021387447,-0.0043623266,0.021911135,-0.026456753,-0.0022479338,0.022518614,-0.012076261,0.008839865,0.06544014,0.032217328,-0.02245577,0.024906633,-0.021387447,-0.022267243,0.0016980605,0.0072845095,-0.002232223,0.0051216753,-0.016747564,0.0010153014,-0.0059595774,-0.01596203,-0.0031159476,0.007865804,-0.001352426,0.006708452,0.021848291,0.04432501,0.0047996067,0.0030635789,0.005970051,0.0031918825,0.046503555,-0.022853775,0.018140577,-0.03569462,-0.02631012,-0.0067608207,0.002114393,-0.047927987,0.02186924,0.0023827835,0.04038687,0.027399393,0.02708518,-0.0071954825,-0.0049986085,0.008447099,0.023817362,0.0087141795,0.019167006,0.03171459,-0.018056786,-0.03100237,0.0109555675,-0.00048113897,-0.026603386,-0.007404958,-0.026268225,0.020413386,0.036092624,0.03605073,0.006766058,-0.04072203,-0.014914654,0.021031337,0.0046503553,0.0011619342,-0.014275754,-0.007740119,-0.026352014,-0.011845838,0.014694705,-0.007965305,-0.009321659,0.022183454,-0.00926929,0.008420914,-0.019533588,0.02212061,-0.00094984035,-0.010599459,0.04065919,-0.040763926,-0.0072792727,0.015637344,0.017501676,-0.0040481137,0.008640863,-0.02262335,-0.031211846,-0.047173876,-0.017910153,-0.0021261761,-0.020329595,0.0020410765,-0.011604941,0.0060957363,-0.027629815,-0.023419358,0.02383831,-0.008913182,0.014359544,0.013720644,-0.013165534,-0.01246379,-0.013479747,0.016820882,-0.005215939,-0.014254806,0.022434823,-0.0067294,0.016140085,0.032741018,-0.0060486044,-0.02289567,-0.0154383425,-0.03295049,-0.0027388919,0.0016155796,-0.0003554537,0.010683249,0.009106946,0.011981997,-0.018915635,-0.0059438664,0.024026837,0.016778985,0.005556337,0.025618851,-0.025095161,0.01268374,-0.03632305,0.047634725,-0.0018433842,0.011311675,0.001266672,0.000273791,-0.010180508,0.020214383,0.0025791668,0.0038831516,0.016768511,-0.010997462,0.008530889,0.016632352,-0.010683249,-0.010520905,-0.01276753,-0.0036867685,-0.025074214,-0.0017753047,-0.0086251525,0.0036684393,0.023084197,-0.025995906,-0.0019926354,-0.016852302,-0.03747516,-0.011112674,-0.03100237,-0.035904095,0.008509941,-0.0052761636,0.008310939,-0.010997462,0.02434105,0.011793469,-0.0077086976,0.009484002,0.0064518447,0.008138122,-0.002922183,-0.036700103,0.00043597084,0.002486212,0.0040454953,-0.008651337,0.012369527,0.004972424,0.009295474,0.0050954907,0.010976515,-0.019889696,0.03049963,-0.00027362735,-0.033704605,0.0038255458,-0.012840847,-0.011929628,-0.0071012187,-0.020497175,0.0050405036,0.018968005,-0.039465178,-0.011803943,-0.016192455,-0.008159069,0.013469273,-0.011699205,-0.02492758,-0.03433303,0.0059019714,0.003820309,-0.02742034,0.007981015,0.013584484,-0.01737599,0.00061827997,-0.00911742,-0.0067398734,-0.0150822345,-0.013102691,-0.002380165,-0.011447835,0.054463625,-0.06799574,0.028279189,0.025178952,0.017302673,-0.0055511002,0.009866294,0.012086735,-0.017470255,0.002888143,-0.035883147,-0.026687175,0.0014047949,-0.00053972664,-0.011741101,-0.029284671,-0.01826626,-0.027650762,-0.003396121,-0.019051794,0.014411912,0.0059019714,0.0038045982,-0.03244775,-0.045498073,-0.0010598149,0.01576303,0.009515423,0.0036867685,-0.019491693,0.019051794,0.0031761718,-0.005100728,-0.01362638,0.0046660663,0.026959494,0.0015435724,0.0077086976,0.01315506,0.006121921,-0.0026996152,0.00625808,0.0043623266,0.01007577,0.024885686,0.030038783,-0.03238491,0.013385483,-0.00075542094,-0.0047446196,0.013165534,-0.017302673,-0.01870616,0.006944112,-0.0019153914,-0.008436625,-0.0036579655,0.010337614,-0.014799442,-0.020978969,-0.007850094,-0.03483577,0.039046228,0.0052892556,-0.001044759,-0.016915144,0.025744535,0.008907945,-0.026016854,-0.01734457,-0.004296866,-0.022497665,-0.0015710661,0.014569019,-0.003095,-0.016768511,0.011269781,-0.016035348,0.0051295306,-0.014621388,-0.026687175,-0.0037339004,0.005886261,-0.008745601,-0.00911742,-0.01826626,0.0104633,-0.008578021,0.015249815,0.00056492916,0.0011265853,-0.04160183,0.017250305,0.034542505,0.0047838963,0.0056348904,-0.0098244,-0.046084605,0.019502167,-0.011196464,-0.010646591,0.025472218,0.018109154,0.011782995,0.027944028,0.0062842644,-0.017616887,-0.016181981,0.010405694,0.00088307005,-0.021492183,-0.0027310364,-0.015522133,-0.009971033,-0.00029097454,0.013563537,0.034479663,-0.03200785,-0.004082153,0.03049963,0.035568934,0.0018931346,0.09166647,0.026100645,-0.012641845,0.012725635,-0.040177397,-0.00017248996,0.0052683083,-0.031630795,-0.025912115,0.0011789541,0.010107191,-0.004925292,0.00872989,-0.014202437,-0.049268633,0.0050221747,-0.02631012,0.023524096,0.019083215,0.02545127,-0.010253824,-0.01584682,0.0016836592,0.004131904,0.00967253,0.0039224285,-0.014736599,0.009389739,0.022581456,0.006446608,0.0038543488,-0.02664528,-0.012641845,0.024278207,0.012757056,-0.022057768,0.03535946,-0.015553554,-0.025262741,0.004498486,-0.008792733,-0.016119137,0.020863757,-0.019198427,0.013888224,0.011175517,0.012558055,-0.023000408,0.017784467,0.009394975,-0.0017687585,-0.011416414,0.015773503,0.010201456,0.011322149,0.009112183,0.020193435,-0.0067189257,-0.02168071,-0.013972014,-0.012306684,-0.013867277,-0.060245145,0.05919777,-0.014998444,-0.021994924,0.033578917,0.0020986823,0.0042235493,-0.009562556,0.0032102116,-0.00049848616,0.025556007,-0.00072858186,-0.025618851,0.030562472,0.009180263,-0.0057029696,0.026247278,-0.00013002208,-0.0033516076,-0.004789133,0.0023042301,0.025933065,0.01904132,0.010871777,-0.002207348,0.00076196704,-0.03108616,0.0033856474,-0.0038805332,-0.014003435,0.020633334,-0.018821372,-0.009499713,-0.04011455,-0.0073787738,-0.002686523,-0.015197446,0.007850094,-0.016946565,-0.0055720476,-0.012097209,-0.053793304,0.025514113,0.0080648055,-0.020999916,0.024361998,0.0016509286,0.028802877,-0.020340068,-0.001801489,0.004723672,0.020528596,-0.0064570815,-0.07993584,0.024382945,-0.02503232,0.015522133,0.009819163,-0.02272809,0.021366498,0.018821372,0.047425248,-0.00034203418,-0.038627278,-0.021261761,0.01951264,-0.022099663,-0.0069598225,0.018088207,0.021020863,-0.020643808,0.019167006,0.0035584646,0.026770966,-0.013395957,-0.018863266,-0.0049514766,-0.0023880205],"index":0,"object":"embedding"}],"model":"embedding-3","object":"list","usage":{"completion_tokens":0,"prompt_tokens":6,"total_tokens":6}}

2026-01-09 15:25:54.256 [tomcat-handler-20] DEBUG c.a.rag.gateway.cache.EmbeddingCache - Cached embedding for textHash: 5eab67cd79781e9f59cc2239ded10d7d545b2e9a5814e9b08f7264743b8601e5, vector dimension: 2048
2026-01-09 15:25:54.256 [tomcat-handler-20] DEBUG c.a.rag.gateway.EmbeddingGateway - Embedding 已缓存：textHash=5eab67cd
2026-01-09 15:25:54.256 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 查询向量化完成，维度：2048
2026-01-09 15:25:54.256 [tomcat-handler-20] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'embedding' completed in 1620 ms
2026-01-09 15:25:54.257 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 查询向量已转换为二进制格式，大小：8192 字节
2026-01-09 15:25:54.257 [tomcat-handler-20] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'vector_conversion' completed in 0 ms
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - FT.SEARCH 原始结果: [[B@46b9a93b, [], [B@769b502e, [B@164cc421, [B@1586508c, [[[B@1e7dc376, [B@324beab7, [B@42565d13, [[B@65f377e5, [B@15e56e5e, [B@78162007, [B@8d844d3, [B@766a4672, [B@48c3417f, [B@19c4678, [B@4b286444, [B@6f55e285, [B@3dcf9ea9], [B@5e83b0ee, []], [[B@5681e53e, [B@160074a1, [B@577b9a1e, [[B@14bc54df, [B@4dcdfb63, [B@587d2b07, [B@535de17c, [B@25314d64, [B@705ac42, [B@36918ab6, [B@afbdb19, [B@258eed4f, [B@f433200], [B@353ddd64, []], [[B@61caebc9, [B@337c862a, [B@25397177, [[B@7e345e49, [B@481676e5, [B@1f0ce41b, [B@71509c44, [B@2dca5231, [B@5690b833, [B@2ec4a2c6, [B@5b03a9e6, [B@24a7236d, [B@772546ea], [B@7cfc085a, []], [[B@3af6d2ba, [B@27d722c2, [B@7a9832c4, [[B@66ba4b15, [B@6a55267a, [B@748ac8c0, [B@4fbfca87, [B@7be9d286, [B@38cc4d77, [B@1aa24e66, [B@2b784447, [B@1e30ce4c, [B@44cd8f08], [B@4c943889, []], [[B@25a71720, [B@3dfdff76, [B@15e0820e, [[B@785db04b, [B@655eb677, [B@378af3e5, [B@26ebe7e8, [B@33a1d496, [B@23dc219b, [B@4329ebde, [B@3a8480f4, [B@73cf656, [B@452edfd3], [B@49d5abb3, []], [[B@57c8015d, [B@37a6d3b4, [B@4c542d4, [[B@60a9e9cc, [B@77fcce6d, [B@76c69855, [B@58bbb7bb, [B@7773d2e9, [B@66edf5cc, [B@242bcd74, [B@21a8b025, [B@48a5ca63, [B@41ef052e], [B@3b55300a, []], [[B@5f1886dd, [B@3908a98f, [B@770df5, [[B@1230b891, [B@985ea64, [B@753d7e0a, [B@4d9dddfd, [B@5a7e10ef, [B@7c8e070e, [B@625debbb, [B@418ca038, [B@6bdf298e, [B@6765e58c], [B@6ae8dae8, []], [[B@4ec12aed, [B@5cc0e9e2, [B@14c13e73, [[B@38528999, [B@7f835a3c, [B@24d723d7, [B@3978a398, [B@15cafb6f, [B@70fd0150, [B@6d294d03, [B@11b1575d, [B@5362c787, [B@4b8dab3a], [B@6c6ba61d, []], [[B@77fb1f72, [B@3260a0f5, [B@141209f8, [[B@25780e29, [B@a57957b, [B@3d07ebcc, [B@395e685d, [B@5c323019, [B@6af89aa9, [B@682355b1, [B@2275c468, [B@6f8a8ac7, [B@4189784d], [B@33752310, []], [[B@3faff792, [B@4488e12, [B@e09c5c6, [[B@14fe1ab4, [B@542d6cde, [B@14d55057, [B@543280fe, [B@30fd0b76, [B@f09da2b, [B@31e07475, [B@719537c7, [B@29eb2438, [B@68f26bac], [B@5a83f91b, []]], [B@270d683, 10, [B@724ae811, []]
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 结果类型: java.util.ArrayList, 大小: 10
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 开始解析搜索结果，result 类型: java.util.ArrayList
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 结果列表大小: 10
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 检测到 NestedMultiOutput 格式
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 找到 results 键，值类型: java.util.ArrayList, 大小: 10
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[0]: List, 大小=6
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[1]: List, 大小=6
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[2]: List, 大小=6
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[3]: List, 大小=6
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[4]: List, 大小=6
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[5]: List, 大小=6
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[6]: List, 大小=6
2026-01-09 15:25:54.259 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[7]: List, 大小=6
2026-01-09 15:25:54.260 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[8]: List, 大小=6
2026-01-09 15:25:54.260 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[9]: List, 大小=6
2026-01-09 15:25:54.260 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 文档列表大小: 6
2026-01-09 15:25:54.260 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[0]: byte[] = "id"
2026-01-09 15:25:54.260 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[1]: byte[] = "chunk:548"
2026-01-09 15:25:54.260 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[2]: byte[] = "extra_attributes"
2026-01-09 15:25:54.267 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[3]: List, 大小=10
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[4]: byte[] = "values"
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[5]: List, 大小=0
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 处理文档 ID: chunk:548
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 字段列表大小: 10
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: __score -> 0.53838968277
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkId -> 548
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: resourceId -> 5
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkIndex -> 0
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkText -> 第二章. Javascript它是一种脚本语言，可以用来更改页面内容，控制多媒体，制作图像、动画等等例子修改页面内容修改页面内容js 代码位置<script>
	// js 代码
</script>
... (长度: 800)
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 文档 chunk:548 解析到 5 个字段: [chunkText, resourceId, chunkIndex, __score, chunkId]
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:25:54.268 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@91e42ff] was not registered for synchronization because synchronization is not active
2026-01-09 15:25:54.270 [tomcat-handler-20] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@1276131814 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will not be managed by Spring
2026-01-09 15:25:54.270 [tomcat-handler-20] DEBUG c.a.rag.mapper.ChunkMapper.findById - ==>  Preparing: SELECT id, resource_id, chunk_index, chunk_text, location_info, page_start, page_end, chapter_path, text_hash, vectorized, created_at FROM resource_chunks WHERE id = ?
2026-01-09 15:25:54.270 [tomcat-handler-20] DEBUG c.a.rag.mapper.ChunkMapper.findById - ==> Parameters: 548(Long)
2026-01-09 15:25:54.272 [tomcat-handler-20] DEBUG c.a.rag.mapper.ChunkMapper.findById - <==      Total: 1
2026-01-09 15:25:54.273 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@91e42ff]
2026-01-09 15:25:54.273 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:25:54.273 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@168df7b8] was not registered for synchronization because synchronization is not active
2026-01-09 15:25:54.273 [tomcat-handler-20] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@1528771462 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will not be managed by Spring
2026-01-09 15:25:54.273 [tomcat-handler-20] DEBUG c.a.r.mapper.ResourceMapper.findById - ==>  Preparing: SELECT id, title, tags, file_type, file_path, file_size, description, content_hash, uploaded_by, upload_time, chunk_count, vectorized FROM resources WHERE id = ?
2026-01-09 15:25:54.273 [tomcat-handler-20] DEBUG c.a.r.mapper.ResourceMapper.findById - ==> Parameters: 5(Long)
2026-01-09 15:25:54.275 [tomcat-handler-20] DEBUG c.a.r.mapper.ResourceMapper.findById - <==      Total: 1
2026-01-09 15:25:54.275 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@168df7b8]
2026-01-09 15:25:54.275 [tomcat-handler-20] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'vector_search' completed in 18 ms
2026-01-09 15:25:54.275 [tomcat-handler-20] INFO  c.a.r.service.impl.SearchServiceImpl - 向量搜索完成，找到 1 个结果，总耗时 1638ms（向量化 1620ms，搜索 18ms）
2026-01-09 15:25:54.275 [tomcat-handler-20] DEBUG c.a.r.service.impl.SearchServiceImpl - 检索到 1 个切片，开始按资源聚合
2026-01-09 15:25:54.275 [tomcat-handler-20] INFO  c.a.r.service.impl.SearchServiceImpl - 聚合后的结果数量：1
2026-01-09 15:25:54.275 [tomcat-handler-20] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'retrieval' completed in 1639 ms
2026-01-09 15:25:54.275 [tomcat-handler-20] DEBUG c.a.rag.service.impl.RagServiceImpl - 证据不足：检索结果数量 1 少于阈值 2
2026-01-09 15:25:54.275 [tomcat-handler-20] WARN  c.a.rag.service.impl.RagServiceImpl - 证据不足：userId=7, citationsCount=1, avgScore=0.53838968277
2026-01-09 15:25:54.275 [tomcat-handler-20] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'generation' completed in 0 ms
2026-01-09 15:25:54.277 [tomcat-handler-20] DEBUG c.a.r.s.impl.BehaviorServiceImpl - 记录用户查询行为: userId=7, queryText=什么是java
2026-01-09 15:25:54.277 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:25:54.277 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5cbc61c5]
2026-01-09 15:25:54.277 [tomcat-handler-20] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@1008960729 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will be managed by Spring
2026-01-09 15:25:54.277 [tomcat-handler-20] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==>  Preparing: INSERT INTO user_behaviors ( user_id, behavior_type, resource_id, query_text, behavior_time, session_id, weight ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2026-01-09 15:25:54.277 [tomcat-handler-20] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==> Parameters: 7(Long), QUERY(String), null, 什么是java(String), 2026-01-09 15:25:54.277267(Timestamp), null, null
2026-01-09 15:25:54.280 [tomcat-handler-20] DEBUG c.a.r.m.UserBehaviorMapper.insert - <==    Updates: 1
2026-01-09 15:25:54.281 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5cbc61c5]
2026-01-09 15:25:54.281 [tomcat-handler-20] INFO  c.a.r.s.impl.BehaviorServiceImpl - 查询行为已记录: behaviorId=65, userId=7
2026-01-09 15:25:54.281 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5cbc61c5]
2026-01-09 15:25:54.281 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5cbc61c5]
2026-01-09 15:25:54.281 [tomcat-handler-20] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5cbc61c5]
2026-01-09 15:25:54.284 [tomcat-handler-20] DEBUG c.a.rag.service.impl.RagServiceImpl - 查询行为记录成功：userId=7, query='什么是java'
2026-01-09 15:25:54.284 [tomcat-handler-20] INFO  c.a.rag.service.impl.RagServiceImpl - 问答完成：userId=7, latencyMs=1648ms, useRag=true, citationsCount=1
2026-01-09 15:25:54.284 [tomcat-handler-20] INFO  c.a.rag.controller.ChatController - RAG 问答完成：userId=7, latencyMs=1648ms, evidenceInsufficient=true
2026-01-09 15:26:48.137 [tomcat-handler-21] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 15:26:48.138 [tomcat-handler-21] INFO  c.a.rag.controller.ChatController - POST /api/chat/ask - userId=7, question='什么是java', topK=5
2026-01-09 15:26:48.138 [tomcat-handler-21] INFO  c.a.rag.service.impl.RagServiceImpl - 执行问答：userId=7, question='什么是java', useRag=false, topK=5
2026-01-09 15:26:48.138 [tomcat-handler-21] INFO  c.a.rag.service.impl.RagServiceImpl - 纯 LLM 模式：跳过检索，直接调用 LLM
2026-01-09 15:26:48.138 [tomcat-handler-21] INFO  c.aetheris.rag.gateway.ChatGateway - 调用 Chat API（带系统提示）：model=glm-4-flash, systemPromptPreview=你是一个专业的学习助手，擅长回答各类学习相关问题。
请遵循以下要求：
1. 使用简洁清晰的语言回答问题
2. 如果遇到不确定的信息，明确说明
3. 避免添加不必要的主观推断
4. 回答应具有教育意义和实用性, userPromptPreview=什么是java
2026-01-09 15:26:48.139 [tomcat-handler-21] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://open.bigmodel.cn/api/paas/v4/chat/completions
- headers: [Authorization: Beare...XI], [Content-Type: application/json]
- body: {
  "model" : "glm-4-flash",
  "messages" : [ {
    "role" : "user",
    "content" : "[系统提示]你是一个专业的学习助手，擅长回答各类学习相关问题。\n请遵循以下要求：\n1. 使用简洁清晰的语言回答问题\n2. 如果遇到不确定的信息，明确说明\n3. 避免添加不必要的主观推断\n4. 回答应具有教育意义和实用性\n\n[用户问题]什么是java"
  } ],
  "stream" : false,
  "temperature" : 0.7,
  "top_p" : 0.9,
  "max_tokens" : 512,
  "stop" : [ ],
  "tool_choice" : "auto"
}

2026-01-09 15:26:57.072 [tomcat-handler-21] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [:status: 200], [content-type: application/json; charset=UTF-8], [date: Fri, 09 Jan 2026 07:26:57 GMT], [set-cookie: acw_tc=0a472f8217679436083375455e503d6246cc02a0a3ed41789328fdd0332216;path=/;HttpOnly;Max-Age=1800], [strict-transport-security: max-age=31536000; includeSubDomains], [vary: [Accept-Encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers, Origin, Access-Control-Request-Method, Access-Control-Request-Headers]], [x-log-id: 20260109152648c480486c211f4fb0]
- body: {"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Java是一种广泛使用的计算机编程语言，由Sun Microsystems公司（现为Oracle公司的一部分）于1995年推出。它是一种面向对象的编程语言，具有“一次编写，到处运行”（Write Once, Run Anywhere，WORA）的特点，这意味着Java编写的程序可以在任何支持Java虚拟机（JVM）的平台上运行。\n\n主要特点如下：\n\n1. **面向对象**：Java是一种纯面向对象的编程语言，它支持类和对象的概念，有助于模块化和重用代码。\n2. **平台无关性**：Java代码编译后生成字节码，由JVM执行，因此可以在任何支持JVM的平台上运行。\n3. **简单易学**：Java设计时考虑了易学性，语法简单，易于理解和掌握。\n4. **安全性**：Java提供了良好的安全机制，可以防止恶意代码对系统造成危害。\n5. **健壮性**：Java的强类型机制和异常处理机制有助于提高代码的健壮性。\n6. **多线程**：Java提供了多线程编程支持，可以有效地利用多核处理器。\n7. **丰富的库**：Java拥有庞大的标准库，包括图形用户界面（GUI）、网络编程、数据库访问等。\n\nJava广泛应用于企业级应用、移动应用（如Android开发）、Web应用、大数据处理等领域。","role":"assistant"}}],"created":1767943617,"id":"20260109152648c480486c211f4fb0","model":"glm-4-flash","object":"chat.completion","request_id":"20260109152648c480486c211f4fb0","usage":{"completion_tokens":274,"prompt_tokens":74,"total_tokens":348}}

2026-01-09 15:26:57.073 [tomcat-handler-21] INFO  c.a.rag.service.impl.RagServiceImpl - LLM 直接生成答案成功：userId=7, answerLength=549
2026-01-09 15:26:57.073 [tomcat-handler-21] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'generation' completed in 8934 ms
2026-01-09 15:26:57.076 [tomcat-handler-21] DEBUG c.a.r.s.impl.BehaviorServiceImpl - 记录用户查询行为: userId=7, queryText=什么是java
2026-01-09 15:26:57.076 [tomcat-handler-21] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:26:57.076 [tomcat-handler-21] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@153841b3]
2026-01-09 15:26:57.076 [tomcat-handler-21] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@532687555 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will be managed by Spring
2026-01-09 15:26:57.076 [tomcat-handler-21] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==>  Preparing: INSERT INTO user_behaviors ( user_id, behavior_type, resource_id, query_text, behavior_time, session_id, weight ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2026-01-09 15:26:57.077 [tomcat-handler-21] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==> Parameters: 7(Long), QUERY(String), null, 什么是java(String), 2026-01-09 15:26:57.076613(Timestamp), null, null
2026-01-09 15:26:57.079 [tomcat-handler-21] DEBUG c.a.r.m.UserBehaviorMapper.insert - <==    Updates: 1
2026-01-09 15:26:57.080 [tomcat-handler-21] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@153841b3]
2026-01-09 15:26:57.080 [tomcat-handler-21] INFO  c.a.r.s.impl.BehaviorServiceImpl - 查询行为已记录: behaviorId=66, userId=7
2026-01-09 15:26:57.080 [tomcat-handler-21] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@153841b3]
2026-01-09 15:26:57.080 [tomcat-handler-21] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@153841b3]
2026-01-09 15:26:57.080 [tomcat-handler-21] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@153841b3]
2026-01-09 15:26:57.083 [tomcat-handler-21] DEBUG c.a.rag.service.impl.RagServiceImpl - 查询行为记录成功：userId=7, query='什么是java'
2026-01-09 15:26:57.083 [tomcat-handler-21] INFO  c.a.rag.service.impl.RagServiceImpl - 问答完成：userId=7, latencyMs=8945ms, useRag=false, citationsCount=0
2026-01-09 15:26:57.084 [tomcat-handler-21] INFO  c.a.rag.controller.ChatController - RAG 问答完成：userId=7, latencyMs=8945ms, evidenceInsufficient=false
2026-01-09 15:27:11.435 [tomcat-handler-22] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 15:27:11.436 [tomcat-handler-22] INFO  c.a.rag.controller.ChatController - POST /api/chat/ask - userId=7, question='什么是vue', topK=5
2026-01-09 15:27:11.436 [tomcat-handler-22] INFO  c.a.rag.service.impl.RagServiceImpl - 执行问答：userId=7, question='什么是vue', useRag=false, topK=5
2026-01-09 15:27:11.436 [tomcat-handler-22] INFO  c.a.rag.service.impl.RagServiceImpl - 纯 LLM 模式：跳过检索，直接调用 LLM
2026-01-09 15:27:11.436 [tomcat-handler-22] INFO  c.aetheris.rag.gateway.ChatGateway - 调用 Chat API（带系统提示）：model=glm-4-flash, systemPromptPreview=你是一个专业的学习助手，擅长回答各类学习相关问题。
请遵循以下要求：
1. 使用简洁清晰的语言回答问题
2. 如果遇到不确定的信息，明确说明
3. 避免添加不必要的主观推断
4. 回答应具有教育意义和实用性, userPromptPreview=什么是vue
2026-01-09 15:27:11.437 [tomcat-handler-22] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://open.bigmodel.cn/api/paas/v4/chat/completions
- headers: [Authorization: Beare...SQ], [Content-Type: application/json]
- body: {
  "model" : "glm-4-flash",
  "messages" : [ {
    "role" : "user",
    "content" : "[系统提示]你是一个专业的学习助手，擅长回答各类学习相关问题。\n请遵循以下要求：\n1. 使用简洁清晰的语言回答问题\n2. 如果遇到不确定的信息，明确说明\n3. 避免添加不必要的主观推断\n4. 回答应具有教育意义和实用性\n\n[用户问题]什么是vue"
  } ],
  "stream" : false,
  "temperature" : 0.7,
  "top_p" : 0.9,
  "max_tokens" : 512,
  "stop" : [ ],
  "tool_choice" : "auto"
}

2026-01-09 15:27:19.992 [tomcat-handler-22] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [:status: 200], [content-type: application/json; charset=UTF-8], [date: Fri, 09 Jan 2026 07:27:20 GMT], [set-cookie: acw_tc=0a472f8217679436315467324e503d5f83f4b96e01656da5be501fe7e95697;path=/;HttpOnly;Max-Age=1800], [strict-transport-security: max-age=31536000; includeSubDomains], [vary: [Accept-Encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers, Origin, Access-Control-Request-Method, Access-Control-Request-Headers]], [x-log-id: 202601091527110923cc974fcd4410]
- body: {"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Vue.js 是一个用于构建用户界面的渐进式JavaScript框架。它易于上手，同时也非常灵活，可以与现有的库或现有项目整合。Vue的核心库只关注视图层，易于与其他库或已有项目结合使用。以下是Vue.js的一些主要特点：\n\n1. **响应式数据绑定**：Vue.js 提供了响应式数据绑定机制，使得数据变化可以自动同步到视图层，反之亦然。\n\n2. **组件系统**：Vue.js 允许开发者使用组件的方式来构建应用，提高了代码的可重用性和模块化。\n\n3. **虚拟DOM**：Vue.js 使用虚拟DOM来优化DOM操作，减少了直接操作DOM的开销，提高了性能。\n\n4. **双向数据流**：Vue.js 提供了双向数据绑定，使得数据与视图之间的同步变得简单。\n\n5. **灵活的配置**：Vue.js 支持渐进式采用，你可以按需引入Vue的核心功能，也可以逐步引入其他功能。\n\n6. **强大的生态系统**：Vue.js 拥有一个强大的生态系统，包括路由管理（Vue Router）、状态管理（Vuex）等。\n\nVue.js 适用于构建单页应用（SPA）、企业级应用、移动端应用等多种类型的应用。","role":"assistant"}}],"created":1767943640,"id":"202601091527110923cc974fcd4410","model":"glm-4-flash","object":"chat.completion","request_id":"202601091527110923cc974fcd4410","usage":{"completion_tokens":258,"prompt_tokens":74,"total_tokens":332}}

2026-01-09 15:27:19.992 [tomcat-handler-22] INFO  c.a.rag.service.impl.RagServiceImpl - LLM 直接生成答案成功：userId=7, answerLength=500
2026-01-09 15:27:19.992 [tomcat-handler-22] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'generation' completed in 8556 ms
2026-01-09 15:27:19.996 [tomcat-handler-22] DEBUG c.a.r.s.impl.BehaviorServiceImpl - 记录用户查询行为: userId=7, queryText=什么是vue
2026-01-09 15:27:19.996 [tomcat-handler-22] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:27:19.996 [tomcat-handler-22] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bd25830]
2026-01-09 15:27:19.996 [tomcat-handler-22] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@988633104 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will be managed by Spring
2026-01-09 15:27:19.996 [tomcat-handler-22] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==>  Preparing: INSERT INTO user_behaviors ( user_id, behavior_type, resource_id, query_text, behavior_time, session_id, weight ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2026-01-09 15:27:19.996 [tomcat-handler-22] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==> Parameters: 7(Long), QUERY(String), null, 什么是vue(String), 2026-01-09 15:27:19.996243(Timestamp), null, null
2026-01-09 15:27:19.999 [tomcat-handler-22] DEBUG c.a.r.m.UserBehaviorMapper.insert - <==    Updates: 1
2026-01-09 15:27:20.000 [tomcat-handler-22] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bd25830]
2026-01-09 15:27:20.000 [tomcat-handler-22] INFO  c.a.r.s.impl.BehaviorServiceImpl - 查询行为已记录: behaviorId=67, userId=7
2026-01-09 15:27:20.000 [tomcat-handler-22] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bd25830]
2026-01-09 15:27:20.000 [tomcat-handler-22] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bd25830]
2026-01-09 15:27:20.000 [tomcat-handler-22] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bd25830]
2026-01-09 15:27:20.004 [tomcat-handler-22] DEBUG c.a.rag.service.impl.RagServiceImpl - 查询行为记录成功：userId=7, query='什么是vue'
2026-01-09 15:27:20.004 [tomcat-handler-22] INFO  c.a.rag.service.impl.RagServiceImpl - 问答完成：userId=7, latencyMs=8567ms, useRag=false, citationsCount=0
2026-01-09 15:27:20.004 [tomcat-handler-22] INFO  c.a.rag.controller.ChatController - RAG 问答完成：userId=7, latencyMs=8567ms, evidenceInsufficient=false
2026-01-09 15:27:25.649 [tomcat-handler-23] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 15:27:25.650 [tomcat-handler-23] INFO  c.a.rag.controller.ChatController - POST /api/chat/ask - userId=7, question='什么是vue', topK=5
2026-01-09 15:27:25.650 [tomcat-handler-23] INFO  c.a.rag.service.impl.RagServiceImpl - 执行问答：userId=7, question='什么是vue', useRag=true, topK=5
2026-01-09 15:27:25.650 [tomcat-handler-23] INFO  c.a.r.service.impl.SearchServiceImpl - 执行聚合语义检索：query='什么是vue', topK=5
2026-01-09 15:27:25.650 [tomcat-handler-23] INFO  c.a.r.service.impl.SearchServiceImpl - 执行语义检索：query='什么是vue', topK=10
2026-01-09 15:27:25.653 [tomcat-handler-23] DEBUG c.a.rag.gateway.cache.EmbeddingCache - Embedding cache hit for textHash: 385b4d7f236e6074b079ad1f52a64f08b322224e205ffac08906f6f4101a1195
2026-01-09 15:27:25.653 [tomcat-handler-23] DEBUG c.a.rag.gateway.EmbeddingGateway - Embedding 缓存命中：textHash=385b4d7f
2026-01-09 15:27:25.653 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 查询向量化完成，维度：2048
2026-01-09 15:27:25.653 [tomcat-handler-23] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'embedding' completed in 2 ms
2026-01-09 15:27:25.653 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 查询向量已转换为二进制格式，大小：8192 字节
2026-01-09 15:27:25.653 [tomcat-handler-23] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'vector_conversion' completed in 0 ms
2026-01-09 15:27:25.658 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - FT.SEARCH 原始结果: [[B@6e5e6e4f, [], [B@3ea3864c, [B@5796414, [B@110cccaa, [[[B@c3df4d2, [B@2e8e82ff, [B@60991afe, [[B@1787e3db, [B@74ff1e9d, [B@2e3ce387, [B@6da5254, [B@2e6bf06f, [B@226c08c9, [B@6b05f7d8, [B@3f99401e, [B@4e00370a, [B@c684443], [B@4897d921, []], [[B@3d7be99d, [B@720c215f, [B@3c883901, [[B@4aa0a160, [B@28f58ea8, [B@3be04430, [B@465d227c, [B@9392076, [B@dbd7f37, [B@34c56b74, [B@1b24e152, [B@5b5e58d0, [B@3d7cc04b], [B@22fd825b, []], [[B@1e6fc927, [B@37de8ae2, [B@6cfb6aca, [[B@225ad254, [B@421c01c9, [B@1561af2, [B@364c9d28, [B@427021c7, [B@60c06209, [B@51706569, [B@38717b2, [B@40ba701c, [B@23098228], [B@7180f00d, []], [[B@4a815308, [B@5928e0d4, [B@365f311b, [[B@40a9af45, [B@70bd4b, [B@1e40d3d1, [B@5158eeeb, [B@5c06a002, [B@5919d42c, [B@41df4a85, [B@57e6cbe3, [B@3e8967ad, [B@29267ce4], [B@12968027, []], [[B@73cef845, [B@68f4d9e, [B@1cd4c0f7, [[B@3a65ecf2, [B@3e6d372b, [B@42726ec5, [B@781bdd04, [B@6d0cac89, [B@3a8f1a6c, [B@6bda5fbe, [B@4d8f5c3c, [B@45efc9e0, [B@7f1f74b], [B@3e6f6fa4, []], [[B@9b6bae9, [B@32adc2f6, [B@3aee2047, [[B@7fb97af1, [B@43e4e61d, [B@1f0226e5, [B@54a5d15a, [B@607f47cd, [B@4cf81d1, [B@af4aaa3, [B@70a195a6, [B@6afae550, [B@12c330d7], [B@3d4d219e, []], [[B@41bd8f34, [B@7c502236, [B@771ef0e3, [[B@230b7e4f, [B@ee28135, [B@73de434d, [B@73472c3d, [B@b46cd1c, [B@11370e68, [B@10f2f328, [B@5a1e03cf, [B@670d0bbd, [B@4e600d7a], [B@490cdc2d, []], [[B@63a6aeb8, [B@6cf90192, [B@22bccaaa, [[B@d7e8764, [B@5b7b2b1d, [B@7faa4471, [B@3b0738b4, [B@423bdd17, [B@409a358e, [B@6d3e6820, [B@6ffe2fab, [B@73b18426, [B@6296f99b], [B@7cf7e281, []], [[B@626a19c3, [B@1d05311c, [B@488a5906, [[B@baa597c, [B@393cedcb, [B@d05a621, [B@175d8cee, [B@4ee556c0, [B@10e9a862, [B@30fd20f0, [B@4b3cf0fd, [B@2f8bfc0c, [B@72fcfb27], [B@2b5faf28, []], [[B@74809a6, [B@77d3eedf, [B@626306c1, [[B@3493d34a, [B@7351e947, [B@1b1c44e4, [B@61b31c48, [B@4b108ab7, [B@37774943, [B@4eb5102d, [B@379d04ef, [B@78176599, [B@75a70689], [B@13f55468, []]], [B@4c108085, 10, [B@fe80f33, []]
2026-01-09 15:27:25.658 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 结果类型: java.util.ArrayList, 大小: 10
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 开始解析搜索结果，result 类型: java.util.ArrayList
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 结果列表大小: 10
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 检测到 NestedMultiOutput 格式
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 找到 results 键，值类型: java.util.ArrayList, 大小: 10
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[0]: List, 大小=6
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[1]: List, 大小=6
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[2]: List, 大小=6
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[3]: List, 大小=6
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[4]: List, 大小=6
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[5]: List, 大小=6
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[6]: List, 大小=6
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[7]: List, 大小=6
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[8]: List, 大小=6
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[9]: List, 大小=6
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 文档列表大小: 6
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[0]: byte[] = "id"
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[1]: byte[] = "chunk:340"
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[2]: byte[] = "extra_attributes"
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[3]: List, 大小=10
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[4]: byte[] = "values"
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[5]: List, 大小=0
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 处理文档 ID: chunk:340
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 字段列表大小: 10
2026-01-09 15:27:25.659 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: __score -> 0.52171087265
2026-01-09 15:27:25.660 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkId -> 340
2026-01-09 15:27:25.660 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: resourceId -> 9
2026-01-09 15:27:25.660 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkIndex -> 10
2026-01-09 15:27:25.660 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkText -> ly() {
    console.log(`${this.name}在飞翔`)
  }
}

const b: Flyable & Animal = new Bird("小花")
b.fly()
... (长度: 938)
2026-01-09 15:27:25.660 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 文档 chunk:340 解析到 5 个字段: [chunkText, resourceId, chunkIndex, __score, chunkId]
2026-01-09 15:27:25.660 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:27:25.660 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@42b6d309] was not registered for synchronization because synchronization is not active
2026-01-09 15:27:25.662 [tomcat-handler-23] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@2077853987 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will not be managed by Spring
2026-01-09 15:27:25.662 [tomcat-handler-23] DEBUG c.a.rag.mapper.ChunkMapper.findById - ==>  Preparing: SELECT id, resource_id, chunk_index, chunk_text, location_info, page_start, page_end, chapter_path, text_hash, vectorized, created_at FROM resource_chunks WHERE id = ?
2026-01-09 15:27:25.662 [tomcat-handler-23] DEBUG c.a.rag.mapper.ChunkMapper.findById - ==> Parameters: 340(Long)
2026-01-09 15:27:25.665 [tomcat-handler-23] DEBUG c.a.rag.mapper.ChunkMapper.findById - <==      Total: 1
2026-01-09 15:27:25.665 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@42b6d309]
2026-01-09 15:27:25.665 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:27:25.665 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c5b3aa1] was not registered for synchronization because synchronization is not active
2026-01-09 15:27:25.665 [tomcat-handler-23] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@134320312 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will not be managed by Spring
2026-01-09 15:27:25.666 [tomcat-handler-23] DEBUG c.a.r.mapper.ResourceMapper.findById - ==>  Preparing: SELECT id, title, tags, file_type, file_path, file_size, description, content_hash, uploaded_by, upload_time, chunk_count, vectorized FROM resources WHERE id = ?
2026-01-09 15:27:25.666 [tomcat-handler-23] DEBUG c.a.r.mapper.ResourceMapper.findById - ==> Parameters: 9(Long)
2026-01-09 15:27:25.669 [tomcat-handler-23] DEBUG c.a.r.mapper.ResourceMapper.findById - <==      Total: 1
2026-01-09 15:27:25.669 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c5b3aa1]
2026-01-09 15:27:25.669 [tomcat-handler-23] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'vector_search' completed in 15 ms
2026-01-09 15:27:25.669 [tomcat-handler-23] INFO  c.a.r.service.impl.SearchServiceImpl - 向量搜索完成，找到 1 个结果，总耗时 18ms（向量化 2ms，搜索 15ms）
2026-01-09 15:27:25.669 [tomcat-handler-23] DEBUG c.a.r.service.impl.SearchServiceImpl - 检索到 1 个切片，开始按资源聚合
2026-01-09 15:27:25.669 [tomcat-handler-23] INFO  c.a.r.service.impl.SearchServiceImpl - 聚合后的结果数量：1
2026-01-09 15:27:25.669 [tomcat-handler-23] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'retrieval' completed in 18 ms
2026-01-09 15:27:25.669 [tomcat-handler-23] DEBUG c.a.rag.service.impl.RagServiceImpl - 证据不足：检索结果数量 1 少于阈值 2
2026-01-09 15:27:25.669 [tomcat-handler-23] WARN  c.a.rag.service.impl.RagServiceImpl - 证据不足：userId=7, citationsCount=1, avgScore=0.52171087265
2026-01-09 15:27:25.669 [tomcat-handler-23] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'generation' completed in 0 ms
2026-01-09 15:27:25.672 [tomcat-handler-23] DEBUG c.a.r.s.impl.BehaviorServiceImpl - 记录用户查询行为: userId=7, queryText=什么是vue
2026-01-09 15:27:25.672 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:27:25.672 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25eac309]
2026-01-09 15:27:25.673 [tomcat-handler-23] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@71413703 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will be managed by Spring
2026-01-09 15:27:25.673 [tomcat-handler-23] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==>  Preparing: INSERT INTO user_behaviors ( user_id, behavior_type, resource_id, query_text, behavior_time, session_id, weight ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2026-01-09 15:27:25.673 [tomcat-handler-23] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==> Parameters: 7(Long), QUERY(String), null, 什么是vue(String), 2026-01-09 15:27:25.672722(Timestamp), null, null
2026-01-09 15:27:25.676 [tomcat-handler-23] DEBUG c.a.r.m.UserBehaviorMapper.insert - <==    Updates: 1
2026-01-09 15:27:25.677 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25eac309]
2026-01-09 15:27:25.677 [tomcat-handler-23] INFO  c.a.r.s.impl.BehaviorServiceImpl - 查询行为已记录: behaviorId=68, userId=7
2026-01-09 15:27:25.677 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25eac309]
2026-01-09 15:27:25.677 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25eac309]
2026-01-09 15:27:25.677 [tomcat-handler-23] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25eac309]
2026-01-09 15:27:25.681 [tomcat-handler-23] DEBUG c.a.rag.service.impl.RagServiceImpl - 查询行为记录成功：userId=7, query='什么是vue'
2026-01-09 15:27:25.681 [tomcat-handler-23] INFO  c.a.rag.service.impl.RagServiceImpl - 问答完成：userId=7, latencyMs=30ms, useRag=true, citationsCount=1
2026-01-09 15:27:25.681 [tomcat-handler-23] INFO  c.a.rag.controller.ChatController - RAG 问答完成：userId=7, latencyMs=30ms, evidenceInsufficient=true
2026-01-09 15:27:39.985 [tomcat-handler-24] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 15:27:39.986 [tomcat-handler-24] INFO  c.a.rag.controller.ChatController - POST /api/chat/ask - userId=7, question='什么是vue', topK=5
2026-01-09 15:27:39.986 [tomcat-handler-24] INFO  c.a.rag.service.impl.RagServiceImpl - 执行问答：userId=7, question='什么是vue', useRag=false, topK=5
2026-01-09 15:27:39.986 [tomcat-handler-24] INFO  c.a.rag.service.impl.RagServiceImpl - 纯 LLM 模式：跳过检索，直接调用 LLM
2026-01-09 15:27:39.986 [tomcat-handler-24] INFO  c.aetheris.rag.gateway.ChatGateway - 调用 Chat API（带系统提示）：model=glm-4-flash, systemPromptPreview=你是一个专业的学习助手，擅长回答各类学习相关问题。
请遵循以下要求：
1. 使用简洁清晰的语言回答问题
2. 如果遇到不确定的信息，明确说明
3. 避免添加不必要的主观推断
4. 回答应具有教育意义和实用性, userPromptPreview=什么是vue
2026-01-09 15:27:39.987 [tomcat-handler-24] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://open.bigmodel.cn/api/paas/v4/chat/completions
- headers: [Authorization: Beare...ao], [Content-Type: application/json]
- body: {
  "model" : "glm-4-flash",
  "messages" : [ {
    "role" : "user",
    "content" : "[系统提示]你是一个专业的学习助手，擅长回答各类学习相关问题。\n请遵循以下要求：\n1. 使用简洁清晰的语言回答问题\n2. 如果遇到不确定的信息，明确说明\n3. 避免添加不必要的主观推断\n4. 回答应具有教育意义和实用性\n\n[用户问题]什么是vue"
  } ],
  "stream" : false,
  "temperature" : 0.7,
  "top_p" : 0.9,
  "max_tokens" : 512,
  "stop" : [ ],
  "tool_choice" : "auto"
}

2026-01-09 15:27:51.361 [tomcat-handler-24] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [:status: 200], [content-type: application/json; charset=UTF-8], [date: Fri, 09 Jan 2026 07:27:51 GMT], [set-cookie: acw_tc=0a472f8217679436601121408e503d23c006074e8913b992edcb88acf74946;path=/;HttpOnly;Max-Age=1800], [strict-transport-security: max-age=31536000; includeSubDomains], [vary: [Accept-Encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers, Origin, Access-Control-Request-Method, Access-Control-Request-Headers]], [x-log-id: 202601091527400d406504e5f24766]
- body: {"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Vue.js 是一款流行的前端JavaScript框架，用于构建用户界面和单页应用程序。它被设计为易于上手，同时具有高效、灵活的特点。Vue的核心库只关注视图层，易于与其他库或已有项目整合。以下是Vue.js的一些主要特点：\n\n1. **响应式数据绑定**：Vue.js能够自动追踪依赖，并在数据变化时更新DOM，这使得开发者无需手动操作DOM。\n2. **组件化**：Vue允许开发者将应用拆分成可复用的组件，提高代码的可维护性和可读性。\n3. **虚拟DOM**：Vue通过虚拟DOM来减少直接操作DOM的次数，从而提高页面渲染的效率。\n4. **双向数据绑定**：Vue支持双向数据绑定，即模型（data）和视图（DOM）之间的双向同步。\n5. **简洁的API**：Vue.js的API设计简洁，易于学习和使用。\n6. **丰富的生态系统**：Vue.js拥有丰富的生态系统，包括官方的Vue Router和Vuex等库。\n\nVue.js广泛应用于各种类型的Web开发，从简单的个人项目到复杂的商业应用。","role":"assistant"}}],"created":1767943671,"id":"202601091527400d406504e5f24766","model":"glm-4-flash","object":"chat.completion","request_id":"202601091527400d406504e5f24766","usage":{"completion_tokens":229,"prompt_tokens":74,"total_tokens":303}}

2026-01-09 15:27:51.361 [tomcat-handler-24] INFO  c.a.rag.service.impl.RagServiceImpl - LLM 直接生成答案成功：userId=7, answerLength=456
2026-01-09 15:27:51.361 [tomcat-handler-24] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'generation' completed in 11375 ms
2026-01-09 15:27:51.364 [tomcat-handler-24] DEBUG c.a.r.s.impl.BehaviorServiceImpl - 记录用户查询行为: userId=7, queryText=什么是vue
2026-01-09 15:27:51.365 [tomcat-handler-24] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:27:51.365 [tomcat-handler-24] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@777e6503]
2026-01-09 15:27:51.365 [tomcat-handler-24] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@394370449 wrapping com.mysql.cj.jdbc.ConnectionImpl@154f8280] will be managed by Spring
2026-01-09 15:27:51.365 [tomcat-handler-24] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==>  Preparing: INSERT INTO user_behaviors ( user_id, behavior_type, resource_id, query_text, behavior_time, session_id, weight ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2026-01-09 15:27:51.365 [tomcat-handler-24] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==> Parameters: 7(Long), QUERY(String), null, 什么是vue(String), 2026-01-09 15:27:51.365003(Timestamp), null, null
2026-01-09 15:27:51.368 [tomcat-handler-24] DEBUG c.a.r.m.UserBehaviorMapper.insert - <==    Updates: 1
2026-01-09 15:27:51.368 [tomcat-handler-24] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@777e6503]
2026-01-09 15:27:51.369 [tomcat-handler-24] INFO  c.a.r.s.impl.BehaviorServiceImpl - 查询行为已记录: behaviorId=69, userId=7
2026-01-09 15:27:51.369 [tomcat-handler-24] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@777e6503]
2026-01-09 15:27:51.369 [tomcat-handler-24] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@777e6503]
2026-01-09 15:27:51.369 [tomcat-handler-24] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@777e6503]
2026-01-09 15:27:51.373 [tomcat-handler-24] DEBUG c.a.rag.service.impl.RagServiceImpl - 查询行为记录成功：userId=7, query='什么是vue'
2026-01-09 15:27:51.373 [tomcat-handler-24] INFO  c.a.rag.service.impl.RagServiceImpl - 问答完成：userId=7, latencyMs=11386ms, useRag=false, citationsCount=0
2026-01-09 15:27:51.373 [tomcat-handler-24] INFO  c.a.rag.controller.ChatController - RAG 问答完成：userId=7, latencyMs=11386ms, evidenceInsufficient=false
2026-01-09 15:57:19.990 [tomcat-handler-25] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 15:57:19.993 [tomcat-handler-25] INFO  c.a.rag.controller.AuthController - GET /api/auth/me - userId: 7
2026-01-09 15:57:19.998 [tomcat-handler-25] DEBUG c.a.rag.service.impl.AuthServiceImpl - 获取当前用户信息: userId=7
2026-01-09 15:57:19.999 [tomcat-handler-25] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 15:57:19.999 [tomcat-handler-25] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16da266b]
2026-01-09 15:57:19.999 [tomcat-handler-25] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@174701936 wrapping com.mysql.cj.jdbc.ConnectionImpl@6527d24] will be managed by Spring
2026-01-09 15:57:19.999 [tomcat-handler-25] DEBUG c.a.rag.mapper.UserMapper.findById - ==>  Preparing: SELECT id, username, email, password_hash, created_at, updated_at, last_active_at FROM users WHERE id = ?
2026-01-09 15:57:19.999 [tomcat-handler-25] DEBUG c.a.rag.mapper.UserMapper.findById - ==> Parameters: 7(Long)
2026-01-09 15:57:20.002 [tomcat-handler-25] DEBUG c.a.rag.mapper.UserMapper.findById - <==      Total: 1
2026-01-09 15:57:20.003 [tomcat-handler-25] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16da266b]
2026-01-09 15:57:20.003 [tomcat-handler-25] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16da266b]
2026-01-09 15:57:20.003 [tomcat-handler-25] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16da266b]
2026-01-09 15:57:20.003 [tomcat-handler-25] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16da266b]
2026-01-09 16:32:31.379 [tomcat-handler-26] INFO  c.a.rag.controller.AuthController - POST /api/auth/login - email: 123@123.com
2026-01-09 16:32:31.379 [tomcat-handler-26] INFO  c.a.rag.service.impl.AuthServiceImpl - 用户登录尝试: 123@123.com
2026-01-09 16:32:31.379 [tomcat-handler-26] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:32:31.379 [tomcat-handler-26] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1cfee26c] was not registered for synchronization because synchronization is not active
2026-01-09 16:32:31.382 [tomcat-handler-26] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@1242965060 wrapping com.mysql.cj.jdbc.ConnectionImpl@42648e0b] will not be managed by Spring
2026-01-09 16:32:31.382 [tomcat-handler-26] DEBUG c.a.r.mapper.UserMapper.findByEmail - ==>  Preparing: SELECT id, username, email, password_hash, created_at, updated_at, last_active_at FROM users WHERE email = ?
2026-01-09 16:32:31.382 [tomcat-handler-26] DEBUG c.a.r.mapper.UserMapper.findByEmail - ==> Parameters: 123@123.com(String)
2026-01-09 16:32:31.384 [tomcat-handler-26] DEBUG c.a.r.mapper.UserMapper.findByEmail - <==      Total: 1
2026-01-09 16:32:31.384 [tomcat-handler-26] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1cfee26c]
2026-01-09 16:32:31.471 [tomcat-handler-26] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:32:31.471 [tomcat-handler-26] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@33b74749] was not registered for synchronization because synchronization is not active
2026-01-09 16:32:31.471 [tomcat-handler-26] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@1148146558 wrapping com.mysql.cj.jdbc.ConnectionImpl@42648e0b] will not be managed by Spring
2026-01-09 16:32:31.472 [tomcat-handler-26] DEBUG c.a.r.m.UserMapper.updateLastActive - ==>  Preparing: UPDATE users SET last_active_at = ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?
2026-01-09 16:32:31.472 [tomcat-handler-26] DEBUG c.a.r.m.UserMapper.updateLastActive - ==> Parameters: 2026-01-09 16:32:31.471014(Timestamp), 7(Long)
2026-01-09 16:32:31.478 [tomcat-handler-26] DEBUG c.a.r.m.UserMapper.updateLastActive - <==    Updates: 1
2026-01-09 16:32:31.478 [tomcat-handler-26] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@33b74749]
2026-01-09 16:32:31.478 [tomcat-handler-26] INFO  c.a.rag.service.impl.AuthServiceImpl - User logged in successfully: 7
2026-01-09 16:32:32.972 [tomcat-handler-27] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 16:32:32.975 [tomcat-handler-27] INFO  c.a.r.controller.ResourceController - GET /api/resources - page=0, size=10
2026-01-09 16:32:32.976 [tomcat-handler-27] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:32:32.976 [tomcat-handler-27] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16eb8bdf] was not registered for synchronization because synchronization is not active
2026-01-09 16:32:32.978 [tomcat-handler-27] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@901591417 wrapping com.mysql.cj.jdbc.ConnectionImpl@42648e0b] will not be managed by Spring
2026-01-09 16:32:32.978 [tomcat-handler-27] DEBUG c.a.r.m.ResourceMapper.findPaged - ==>  Preparing: SELECT id, title, tags, file_type, file_path, file_size, description, content_hash, uploaded_by, upload_time, chunk_count, vectorized FROM resources ORDER BY upload_time DESC LIMIT ?, ?
2026-01-09 16:32:32.978 [tomcat-handler-27] DEBUG c.a.r.m.ResourceMapper.findPaged - ==> Parameters: 0(Integer), 10(Integer)
2026-01-09 16:32:32.981 [tomcat-handler-27] DEBUG c.a.r.m.ResourceMapper.findPaged - <==      Total: 9
2026-01-09 16:32:32.981 [tomcat-handler-27] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16eb8bdf]
2026-01-09 16:32:32.981 [tomcat-handler-27] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:32:32.982 [tomcat-handler-27] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f68b5b9] was not registered for synchronization because synchronization is not active
2026-01-09 16:32:32.982 [tomcat-handler-27] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@222396184 wrapping com.mysql.cj.jdbc.ConnectionImpl@42648e0b] will not be managed by Spring
2026-01-09 16:32:32.982 [tomcat-handler-27] DEBUG c.a.rag.mapper.ResourceMapper.count - ==>  Preparing: SELECT COUNT(*) FROM resources
2026-01-09 16:32:32.982 [tomcat-handler-27] DEBUG c.a.rag.mapper.ResourceMapper.count - ==> Parameters: 
2026-01-09 16:32:32.985 [tomcat-handler-27] DEBUG c.a.rag.mapper.ResourceMapper.count - <==      Total: 1
2026-01-09 16:32:32.986 [tomcat-handler-27] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f68b5b9]
2026-01-09 16:32:39.504 [tomcat-handler-28] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 16:32:39.507 [tomcat-handler-28] INFO  c.a.r.controller.ResourceController - GET /api/resources - page=0, size=10
2026-01-09 16:32:39.507 [tomcat-handler-28] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:32:39.507 [tomcat-handler-28] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@42aa98d8] was not registered for synchronization because synchronization is not active
2026-01-09 16:32:39.509 [tomcat-handler-28] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@1822035541 wrapping com.mysql.cj.jdbc.ConnectionImpl@42648e0b] will not be managed by Spring
2026-01-09 16:32:39.509 [tomcat-handler-28] DEBUG c.a.r.m.ResourceMapper.findPaged - ==>  Preparing: SELECT id, title, tags, file_type, file_path, file_size, description, content_hash, uploaded_by, upload_time, chunk_count, vectorized FROM resources ORDER BY upload_time DESC LIMIT ?, ?
2026-01-09 16:32:39.509 [tomcat-handler-28] DEBUG c.a.r.m.ResourceMapper.findPaged - ==> Parameters: 0(Integer), 10(Integer)
2026-01-09 16:32:39.513 [tomcat-handler-28] DEBUG c.a.r.m.ResourceMapper.findPaged - <==      Total: 9
2026-01-09 16:32:39.513 [tomcat-handler-28] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@42aa98d8]
2026-01-09 16:32:39.513 [tomcat-handler-28] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:32:39.513 [tomcat-handler-28] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@632f50e] was not registered for synchronization because synchronization is not active
2026-01-09 16:32:39.513 [tomcat-handler-28] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@988195643 wrapping com.mysql.cj.jdbc.ConnectionImpl@42648e0b] will not be managed by Spring
2026-01-09 16:32:39.513 [tomcat-handler-28] DEBUG c.a.rag.mapper.ResourceMapper.count - ==>  Preparing: SELECT COUNT(*) FROM resources
2026-01-09 16:32:39.514 [tomcat-handler-28] DEBUG c.a.rag.mapper.ResourceMapper.count - ==> Parameters: 
2026-01-09 16:32:39.515 [tomcat-handler-28] DEBUG c.a.rag.mapper.ResourceMapper.count - <==      Total: 1
2026-01-09 16:32:39.516 [tomcat-handler-28] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@632f50e]
2026-01-09 16:32:49.039 [tomcat-handler-29] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 16:32:49.040 [tomcat-handler-29] INFO  c.a.rag.controller.ChatController - POST /api/chat/ask - userId=7, question='什么是vue', topK=5
2026-01-09 16:32:49.040 [tomcat-handler-29] INFO  c.a.rag.service.impl.RagServiceImpl - 执行问答：userId=7, question='什么是vue', useRag=true, topK=5
2026-01-09 16:32:49.040 [tomcat-handler-29] INFO  c.a.r.service.impl.SearchServiceImpl - 执行聚合语义检索：query='什么是vue', topK=5
2026-01-09 16:32:49.040 [tomcat-handler-29] INFO  c.a.r.service.impl.SearchServiceImpl - 执行语义检索：query='什么是vue', topK=10
2026-01-09 16:32:49.043 [tomcat-handler-29] DEBUG c.a.rag.gateway.cache.EmbeddingCache - Embedding cache hit for textHash: 385b4d7f236e6074b079ad1f52a64f08b322224e205ffac08906f6f4101a1195
2026-01-09 16:32:49.043 [tomcat-handler-29] DEBUG c.a.rag.gateway.EmbeddingGateway - Embedding 缓存命中：textHash=385b4d7f
2026-01-09 16:32:49.043 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 查询向量化完成，维度：2048
2026-01-09 16:32:49.043 [tomcat-handler-29] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'embedding' completed in 3 ms
2026-01-09 16:32:49.043 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 查询向量已转换为二进制格式，大小：8192 字节
2026-01-09 16:32:49.044 [tomcat-handler-29] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'vector_conversion' completed in 0 ms
2026-01-09 16:32:49.046 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - FT.SEARCH 原始结果: [[B@2c9f9f50, [], [B@3d149548, [B@32244ea2, [B@2155fdce, [[[B@716083ab, [B@68c7e61a, [B@7886e4fe, [[B@76b3ddad, [B@3bb650b, [B@541bb450, [B@1bf51b39, [B@73c3e35f, [B@2b085311, [B@22b8cb14, [B@11a720a9, [B@7d92f0d9, [B@14ebb4a1], [B@706f2d43, []], [[B@5865f98f, [B@329bde62, [B@7b1c3a2c, [[B@72900539, [B@54e3365, [B@694a8560, [B@731d0f3f, [B@1d675a8, [B@75f7bbec, [B@482b41b7, [B@53d4db7a, [B@611d8f9d, [B@297d7089], [B@3b49aae8, []], [[B@4e33a9f0, [B@43dfa6cc, [B@1e47f06, [[B@778c8b38, [B@2423d010, [B@1af4eb9e, [B@38caab89, [B@2b0c22e3, [B@1115c4c2, [B@2c807565, [B@41fb059f, [B@b2a3c79, [B@34a6da0a], [B@1ba2baa6, []], [[B@26c83b0, [B@58ffae70, [B@5a0b49ef, [[B@54f2bf82, [B@3265d7af, [B@17cc73bd, [B@1788049a, [B@56c7a746, [B@4a03da9e, [B@3e2619f8, [B@69dd6672, [B@24b0198, [B@56c8fc65], [B@582fc69d, []], [[B@5a43d51c, [B@5e480d, [B@1164a7b7, [[B@37598028, [B@737648ea, [B@11a78a9, [B@35f73e22, [B@4ed4b074, [B@f24805c, [B@5d296e21, [B@51235d88, [B@3a1f00c8, [B@111251b7], [B@7dc7dd2, []], [[B@4cd8afbc, [B@e83efaf, [B@d1f8821, [[B@69c946bd, [B@6065a177, [B@710ac443, [B@2504c3, [B@23fa46d4, [B@6ed925c5, [B@4956cc81, [B@61fdda74, [B@1040ec79, [B@379004b9], [B@485de40e, []], [[B@477cb90b, [B@50c8b6b9, [B@674ad5d5, [[B@409020a6, [B@62867d5e, [B@776e62c9, [B@463bf58c, [B@76f68fd, [B@56d289c3, [B@52aec1fa, [B@4b20d9b6, [B@377468af, [B@75aa7313], [B@51afdd4d, []], [[B@1c8f53a7, [B@8aa6189, [B@2e3ea964, [[B@1545c5b, [B@67a025bd, [B@3cddb6e9, [B@67734d9f, [B@446663ae, [B@220d2b52, [B@73b6ab04, [B@ed40f58, [B@79d8663f, [B@324485ed], [B@746cf62a, []], [[B@5a6c9930, [B@603ff5dc, [B@76c27fdb, [[B@650c1a8f, [B@5b17ba07, [B@441935ac, [B@21c0b653, [B@249d0886, [B@42bc5990, [B@4f05b03e, [B@6b53e5a3, [B@27c60977, [B@716a4c6], [B@65f0705a, []], [[B@117aefba, [B@6e0d153, [B@34e275dd, [[B@52f6a1bb, [B@14379360, [B@145da2fc, [B@33366137, [B@542af593, [B@7caec0e5, [B@59dc7ce, [B@5a22193, [B@627cad9, [B@c848b10], [B@67cc9ef9, []]], [B@7376952a, 10, [B@4b3ff89f, []]
2026-01-09 16:32:49.046 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 结果类型: java.util.ArrayList, 大小: 10
2026-01-09 16:32:49.046 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 开始解析搜索结果，result 类型: java.util.ArrayList
2026-01-09 16:32:49.046 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 结果列表大小: 10
2026-01-09 16:32:49.046 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 检测到 NestedMultiOutput 格式
2026-01-09 16:32:49.046 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 找到 results 键，值类型: java.util.ArrayList, 大小: 10
2026-01-09 16:32:49.046 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[0]: List, 大小=6
2026-01-09 16:32:49.046 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[1]: List, 大小=6
2026-01-09 16:32:49.046 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[2]: List, 大小=6
2026-01-09 16:32:49.046 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[3]: List, 大小=6
2026-01-09 16:32:49.046 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[4]: List, 大小=6
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[5]: List, 大小=6
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[6]: List, 大小=6
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[7]: List, 大小=6
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[8]: List, 大小=6
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   resultsValue[9]: List, 大小=6
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 文档列表大小: 6
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[0]: byte[] = "id"
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[1]: byte[] = "chunk:340"
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[2]: byte[] = "extra_attributes"
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[3]: List, 大小=10
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[4]: byte[] = "values"
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   docList[5]: List, 大小=0
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 处理文档 ID: chunk:340
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 字段列表大小: 10
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: __score -> 0.52171087265
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkId -> 340
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: resourceId -> 9
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkIndex -> 10
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl -   字段: chunkText -> ly() {
    console.log(`${this.name}在飞翔`)
  }
}

const b: Flyable & Animal = new Bird("小花")
b.fly()
... (长度: 938)
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 文档 chunk:340 解析到 5 个字段: [chunkText, resourceId, chunkIndex, __score, chunkId]
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:32:49.047 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63cb36e3] was not registered for synchronization because synchronization is not active
2026-01-09 16:32:49.048 [tomcat-handler-29] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@1618167605 wrapping com.mysql.cj.jdbc.ConnectionImpl@42648e0b] will not be managed by Spring
2026-01-09 16:32:49.048 [tomcat-handler-29] DEBUG c.a.rag.mapper.ChunkMapper.findById - ==>  Preparing: SELECT id, resource_id, chunk_index, chunk_text, location_info, page_start, page_end, chapter_path, text_hash, vectorized, created_at FROM resource_chunks WHERE id = ?
2026-01-09 16:32:49.049 [tomcat-handler-29] DEBUG c.a.rag.mapper.ChunkMapper.findById - ==> Parameters: 340(Long)
2026-01-09 16:32:49.051 [tomcat-handler-29] DEBUG c.a.rag.mapper.ChunkMapper.findById - <==      Total: 1
2026-01-09 16:32:49.051 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63cb36e3]
2026-01-09 16:32:49.051 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:32:49.051 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1324aeb6] was not registered for synchronization because synchronization is not active
2026-01-09 16:32:49.051 [tomcat-handler-29] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@702742047 wrapping com.mysql.cj.jdbc.ConnectionImpl@42648e0b] will not be managed by Spring
2026-01-09 16:32:49.051 [tomcat-handler-29] DEBUG c.a.r.mapper.ResourceMapper.findById - ==>  Preparing: SELECT id, title, tags, file_type, file_path, file_size, description, content_hash, uploaded_by, upload_time, chunk_count, vectorized FROM resources WHERE id = ?
2026-01-09 16:32:49.051 [tomcat-handler-29] DEBUG c.a.r.mapper.ResourceMapper.findById - ==> Parameters: 9(Long)
2026-01-09 16:32:49.054 [tomcat-handler-29] DEBUG c.a.r.mapper.ResourceMapper.findById - <==      Total: 1
2026-01-09 16:32:49.054 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1324aeb6]
2026-01-09 16:32:49.054 [tomcat-handler-29] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'vector_search' completed in 10 ms
2026-01-09 16:32:49.054 [tomcat-handler-29] INFO  c.a.r.service.impl.SearchServiceImpl - 向量搜索完成，找到 1 个结果，总耗时 14ms（向量化 3ms，搜索 10ms）
2026-01-09 16:32:49.054 [tomcat-handler-29] DEBUG c.a.r.service.impl.SearchServiceImpl - 检索到 1 个切片，开始按资源聚合
2026-01-09 16:32:49.054 [tomcat-handler-29] INFO  c.a.r.service.impl.SearchServiceImpl - 聚合后的结果数量：1
2026-01-09 16:32:49.055 [tomcat-handler-29] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'retrieval' completed in 14 ms
2026-01-09 16:32:49.055 [tomcat-handler-29] DEBUG c.a.rag.service.impl.RagServiceImpl - 证据不足：检索结果数量 1 少于阈值 2
2026-01-09 16:32:49.055 [tomcat-handler-29] WARN  c.a.rag.service.impl.RagServiceImpl - 证据不足：userId=7, citationsCount=1, avgScore=0.52171087265
2026-01-09 16:32:49.055 [tomcat-handler-29] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'generation' completed in 0 ms
2026-01-09 16:32:49.056 [tomcat-handler-29] DEBUG c.a.r.s.impl.BehaviorServiceImpl - 记录用户查询行为: userId=7, queryText=什么是vue
2026-01-09 16:32:49.057 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:32:49.057 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e4ad0b6]
2026-01-09 16:32:49.057 [tomcat-handler-29] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@646024651 wrapping com.mysql.cj.jdbc.ConnectionImpl@42648e0b] will be managed by Spring
2026-01-09 16:32:49.057 [tomcat-handler-29] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==>  Preparing: INSERT INTO user_behaviors ( user_id, behavior_type, resource_id, query_text, behavior_time, session_id, weight ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2026-01-09 16:32:49.057 [tomcat-handler-29] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==> Parameters: 7(Long), QUERY(String), null, 什么是vue(String), 2026-01-09 16:32:49.056979(Timestamp), null, null
2026-01-09 16:32:49.060 [tomcat-handler-29] DEBUG c.a.r.m.UserBehaviorMapper.insert - <==    Updates: 1
2026-01-09 16:32:49.060 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e4ad0b6]
2026-01-09 16:32:49.060 [tomcat-handler-29] INFO  c.a.r.s.impl.BehaviorServiceImpl - 查询行为已记录: behaviorId=70, userId=7
2026-01-09 16:32:49.060 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e4ad0b6]
2026-01-09 16:32:49.060 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e4ad0b6]
2026-01-09 16:32:49.060 [tomcat-handler-29] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e4ad0b6]
2026-01-09 16:32:49.064 [tomcat-handler-29] DEBUG c.a.rag.service.impl.RagServiceImpl - 查询行为记录成功：userId=7, query='什么是vue'
2026-01-09 16:32:49.064 [tomcat-handler-29] INFO  c.a.rag.service.impl.RagServiceImpl - 问答完成：userId=7, latencyMs=23ms, useRag=true, citationsCount=1
2026-01-09 16:32:49.064 [tomcat-handler-29] INFO  c.a.rag.controller.ChatController - RAG 问答完成：userId=7, latencyMs=23ms, evidenceInsufficient=true
2026-01-09 16:32:52.364 [tomcat-handler-30] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 16:32:52.364 [tomcat-handler-31] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 16:32:52.366 [tomcat-handler-30] INFO  c.a.r.controller.ResourceController - GET /api/resources/9
2026-01-09 16:32:52.366 [tomcat-handler-30] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:32:52.366 [tomcat-handler-30] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@473a0b2] was not registered for synchronization because synchronization is not active
2026-01-09 16:32:52.366 [tomcat-handler-31] INFO  c.a.r.controller.ResourceController - GET /api/resources/9/chunks
2026-01-09 16:32:52.366 [tomcat-handler-31] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:32:52.366 [tomcat-handler-31] DEBUG org.mybatis.spring.SqlSessionUtils - SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b4eea5e] was not registered for synchronization because synchronization is not active
2026-01-09 16:32:52.368 [tomcat-handler-31] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@1873421728 wrapping com.mysql.cj.jdbc.ConnectionImpl@6a5f90f8] will not be managed by Spring
2026-01-09 16:32:52.368 [tomcat-handler-30] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@1447527139 wrapping com.mysql.cj.jdbc.ConnectionImpl@42648e0b] will not be managed by Spring
2026-01-09 16:32:52.368 [tomcat-handler-31] DEBUG c.a.r.m.ChunkMapper.findByResourceId - ==>  Preparing: SELECT id, resource_id, chunk_index, chunk_text, location_info, page_start, page_end, chapter_path, text_hash, vectorized, created_at FROM resource_chunks WHERE resource_id = ? ORDER BY chunk_index ASC
2026-01-09 16:32:52.368 [tomcat-handler-30] DEBUG c.a.r.mapper.ResourceMapper.findById - ==>  Preparing: SELECT id, title, tags, file_type, file_path, file_size, description, content_hash, uploaded_by, upload_time, chunk_count, vectorized FROM resources WHERE id = ?
2026-01-09 16:32:52.368 [tomcat-handler-31] DEBUG c.a.r.m.ChunkMapper.findByResourceId - ==> Parameters: 9(Long)
2026-01-09 16:32:52.368 [tomcat-handler-30] DEBUG c.a.r.mapper.ResourceMapper.findById - ==> Parameters: 9(Long)
2026-01-09 16:32:52.370 [tomcat-handler-30] DEBUG c.a.r.mapper.ResourceMapper.findById - <==      Total: 1
2026-01-09 16:32:52.371 [tomcat-handler-30] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@473a0b2]
2026-01-09 16:32:52.382 [tomcat-handler-31] DEBUG c.a.r.m.ChunkMapper.findByResourceId - <==      Total: 78
2026-01-09 16:32:52.382 [tomcat-handler-31] DEBUG org.mybatis.spring.SqlSessionUtils - Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b4eea5e]
2026-01-09 16:32:58.782 [tomcat-handler-32] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 16:32:58.783 [tomcat-handler-32] INFO  c.a.rag.controller.ChatController - POST /api/chat/ask - userId=7, question='什么是vue', topK=5
2026-01-09 16:32:58.783 [tomcat-handler-32] INFO  c.a.rag.service.impl.RagServiceImpl - 执行问答：userId=7, question='什么是vue', useRag=false, topK=5
2026-01-09 16:32:58.783 [tomcat-handler-32] INFO  c.a.rag.service.impl.RagServiceImpl - 纯 LLM 模式：跳过检索，直接调用 LLM
2026-01-09 16:32:58.783 [tomcat-handler-32] INFO  c.aetheris.rag.gateway.ChatGateway - 调用 Chat API（带系统提示）：model=glm-4-flash, systemPromptPreview=你是一个专业的学习助手，擅长回答各类学习相关问题。
请遵循以下要求：
1. 使用简洁清晰的语言回答问题
2. 如果遇到不确定的信息，明确说明
3. 避免添加不必要的主观推断
4. 回答应具有教育意义和实用性, userPromptPreview=什么是vue
2026-01-09 16:32:58.798 [tomcat-handler-32] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://open.bigmodel.cn/api/paas/v4/chat/completions
- headers: [Authorization: Beare...No], [Content-Type: application/json]
- body: {
  "model" : "glm-4-flash",
  "messages" : [ {
    "role" : "user",
    "content" : "[系统提示]你是一个专业的学习助手，擅长回答各类学习相关问题。\n请遵循以下要求：\n1. 使用简洁清晰的语言回答问题\n2. 如果遇到不确定的信息，明确说明\n3. 避免添加不必要的主观推断\n4. 回答应具有教育意义和实用性\n\n[用户问题]什么是vue"
  } ],
  "stream" : false,
  "temperature" : 0.7,
  "top_p" : 0.9,
  "max_tokens" : 512,
  "stop" : [ ],
  "tool_choice" : "auto"
}

2026-01-09 16:33:07.160 [tomcat-handler-32] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [:status: 200], [content-type: application/json; charset=UTF-8], [date: Fri, 09 Jan 2026 08:33:07 GMT], [set-cookie: acw_tc=ac11000117679475791511317e4a44a0da7fdeef4f4e7e259ec9ff4af07444;path=/;HttpOnly;Max-Age=1800], [strict-transport-security: max-age=31536000; includeSubDomains], [vary: [Accept-Encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers, Origin, Access-Control-Request-Method, Access-Control-Request-Headers]], [x-log-id: 20260109163259bd904f3b849a4406]
- body: {"choices":[{"finish_reason":"stop","index":0,"message":{"content":"Vue.js 是一款流行的前端JavaScript框架，用于构建用户界面和单页应用程序（SPA）。它由尤雨溪（Evan You）创建，于2014年发布。Vue.js的特点包括：\n\n1. **组件化**：允许开发者将应用程序分解为可复用的组件，使得代码更加模块化和易于维护。\n2. **响应式**：Vue.js 提供了响应式数据绑定，当数据变化时，视图会自动更新。\n3. **双向数据绑定**：Vue.js 允许开发者通过指令（如v-model）实现数据与视图的双向绑定。\n4. **虚拟DOM**：Vue.js 使用虚拟DOM来提高DOM操作的效率。\n5. **易学易用**：Vue.js 设计简单，易于上手，适合初学者和专业人士。\n\nVue.js广泛应用于各种项目，从简单的个人项目到复杂的商业应用。它具有丰富的生态系统和社区支持，是现代前端开发的一个重要选择。","role":"assistant"}}],"created":1767947587,"id":"20260109163259bd904f3b849a4406","model":"glm-4-flash","object":"chat.completion","request_id":"20260109163259bd904f3b849a4406","usage":{"completion_tokens":199,"prompt_tokens":74,"total_tokens":273}}

2026-01-09 16:33:07.161 [tomcat-handler-32] INFO  c.a.rag.service.impl.RagServiceImpl - LLM 直接生成答案成功：userId=7, answerLength=382
2026-01-09 16:33:07.161 [tomcat-handler-32] DEBUG c.aetheris.rag.util.PerformanceTimer - Stage 'generation' completed in 8377 ms
2026-01-09 16:33:07.163 [tomcat-handler-32] DEBUG c.a.r.s.impl.BehaviorServiceImpl - 记录用户查询行为: userId=7, queryText=什么是vue
2026-01-09 16:33:07.163 [tomcat-handler-32] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:33:07.164 [tomcat-handler-32] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3e1b43b4]
2026-01-09 16:33:07.164 [tomcat-handler-32] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@835942840 wrapping com.mysql.cj.jdbc.ConnectionImpl@42648e0b] will be managed by Spring
2026-01-09 16:33:07.164 [tomcat-handler-32] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==>  Preparing: INSERT INTO user_behaviors ( user_id, behavior_type, resource_id, query_text, behavior_time, session_id, weight ) VALUES ( ?, ?, ?, ?, ?, ?, ? )
2026-01-09 16:33:07.164 [tomcat-handler-32] DEBUG c.a.r.m.UserBehaviorMapper.insert - ==> Parameters: 7(Long), QUERY(String), null, 什么是vue(String), 2026-01-09 16:33:07.163914(Timestamp), null, null
2026-01-09 16:33:07.166 [tomcat-handler-32] DEBUG c.a.r.m.UserBehaviorMapper.insert - <==    Updates: 1
2026-01-09 16:33:07.167 [tomcat-handler-32] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3e1b43b4]
2026-01-09 16:33:07.167 [tomcat-handler-32] INFO  c.a.r.s.impl.BehaviorServiceImpl - 查询行为已记录: behaviorId=71, userId=7
2026-01-09 16:33:07.167 [tomcat-handler-32] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3e1b43b4]
2026-01-09 16:33:07.167 [tomcat-handler-32] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3e1b43b4]
2026-01-09 16:33:07.167 [tomcat-handler-32] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3e1b43b4]
2026-01-09 16:33:07.170 [tomcat-handler-32] DEBUG c.a.rag.service.impl.RagServiceImpl - 查询行为记录成功：userId=7, query='什么是vue'
2026-01-09 16:33:07.170 [tomcat-handler-32] INFO  c.a.rag.service.impl.RagServiceImpl - 问答完成：userId=7, latencyMs=8387ms, useRag=false, citationsCount=0
2026-01-09 16:33:07.170 [tomcat-handler-32] INFO  c.a.rag.controller.ChatController - RAG 问答完成：userId=7, latencyMs=8387ms, evidenceInsufficient=false
2026-01-09 16:33:39.060 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Retrograde clock change detected (housekeeper delta=29s840ms), soft-evicting connections from pool.
2026-01-09 16:36:30.976 [tomcat-handler-33] DEBUG c.a.r.c.SecurityConfig$JwtAuthenticationFilter - Authenticated user: 7
2026-01-09 16:36:30.978 [tomcat-handler-33] INFO  c.a.rag.controller.AuthController - GET /api/auth/me - userId: 7
2026-01-09 16:36:30.983 [tomcat-handler-33] DEBUG c.a.rag.service.impl.AuthServiceImpl - 获取当前用户信息: userId=7
2026-01-09 16:36:30.983 [tomcat-handler-33] DEBUG org.mybatis.spring.SqlSessionUtils - Creating a new SqlSession
2026-01-09 16:36:30.984 [tomcat-handler-33] DEBUG org.mybatis.spring.SqlSessionUtils - Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@255da155]
2026-01-09 16:36:30.984 [tomcat-handler-33] DEBUG o.m.s.t.SpringManagedTransaction - JDBC Connection [HikariProxyConnection@799394341 wrapping com.mysql.cj.jdbc.ConnectionImpl@6aa751b5] will be managed by Spring
2026-01-09 16:36:30.984 [tomcat-handler-33] DEBUG c.a.rag.mapper.UserMapper.findById - ==>  Preparing: SELECT id, username, email, password_hash, created_at, updated_at, last_active_at FROM users WHERE id = ?
2026-01-09 16:36:30.984 [tomcat-handler-33] DEBUG c.a.rag.mapper.UserMapper.findById - ==> Parameters: 7(Long)
2026-01-09 16:36:30.986 [tomcat-handler-33] DEBUG c.a.rag.mapper.UserMapper.findById - <==      Total: 1
2026-01-09 16:36:30.987 [tomcat-handler-33] DEBUG org.mybatis.spring.SqlSessionUtils - Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@255da155]
2026-01-09 16:36:30.987 [tomcat-handler-33] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@255da155]
2026-01-09 16:36:30.987 [tomcat-handler-33] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@255da155]
2026-01-09 16:36:30.987 [tomcat-handler-33] DEBUG org.mybatis.spring.SqlSessionUtils - Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@255da155]
2026-01-09 16:39:29.683 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m50s611ms).
2026-01-09 17:09:48.154 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2026-01-09 17:09:48.157 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2026-01-09 17:09:48.280 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2026-01-09 17:09:48.281 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
